\hypertarget{mtk__lapack__adapter_8cc_source}{\section{mtk\+\_\+lapack\+\_\+adapter.\+cc}
\label{mtk__lapack__adapter_8cc_source}\index{src/mtk\+\_\+lapack\+\_\+adapter.\+cc@{src/mtk\+\_\+lapack\+\_\+adapter.\+cc}}
}

\begin{DoxyCode}
00001 
00021 \textcolor{comment}{/*}
00022 \textcolor{comment}{Copyright (C) 2015, Computational Science Research Center, San Diego State}
00023 \textcolor{comment}{University. All rights reserved.}
00024 \textcolor{comment}{}
00025 \textcolor{comment}{Redistribution and use in source and binary forms, with or without modification,}
00026 \textcolor{comment}{are permitted provided that the following conditions are met:}
00027 \textcolor{comment}{}
00028 \textcolor{comment}{1. Modifications to source code should be reported to: esanchez@mail.sdsu.edu}
00029 \textcolor{comment}{and a copy of the modified files should be reported once modifications are}
00030 \textcolor{comment}{completed, unless these modifications are made through the project's GitHub}
00031 \textcolor{comment}{page: http://www.csrc.sdsu.edu/mtk. Documentation related to said modifications}
00032 \textcolor{comment}{should be developed and included in any deliverable.}
00033 \textcolor{comment}{}
00034 \textcolor{comment}{2. Redistributions of source code must be done through direct}
00035 \textcolor{comment}{downloads from the project's GitHub page: http://www.csrc.sdsu.edu/mtk}
00036 \textcolor{comment}{}
00037 \textcolor{comment}{3. Redistributions in binary form must reproduce the above copyright notice,}
00038 \textcolor{comment}{this list of conditions and the following disclaimer in the documentation and/or}
00039 \textcolor{comment}{other materials provided with the distribution.}
00040 \textcolor{comment}{}
00041 \textcolor{comment}{4. Usage of the binary form on proprietary applications shall require explicit}
00042 \textcolor{comment}{prior written permission from the the copyright holders, and due credit should}
00043 \textcolor{comment}{be given to the copyright holders.}
00044 \textcolor{comment}{}
00045 \textcolor{comment}{5. Neither the name of the copyright holder nor the names of its contributors}
00046 \textcolor{comment}{may be used to endorse or promote products derived from this software without}
00047 \textcolor{comment}{specific prior written permission.}
00048 \textcolor{comment}{}
00049 \textcolor{comment}{The copyright holders provide no reassurances that the source code provided does}
00050 \textcolor{comment}{not infringe any patent, copyright, or any other intellectual property rights of}
00051 \textcolor{comment}{third parties. The copyright holders disclaim any liability to any recipient for}
00052 \textcolor{comment}{claims brought against recipient by any third party for infringement of that}
00053 \textcolor{comment}{parties intellectual property rights.}
00054 \textcolor{comment}{}
00055 \textcolor{comment}{THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND}
00056 \textcolor{comment}{ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED}
00057 \textcolor{comment}{WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE}
00058 \textcolor{comment}{DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR}
00059 \textcolor{comment}{ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES}
00060 \textcolor{comment}{(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;}
00061 \textcolor{comment}{LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON}
00062 \textcolor{comment}{ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT}
00063 \textcolor{comment}{(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS}
00064 \textcolor{comment}{SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.}
00065 \textcolor{comment}{*/}
00066 
00067 \textcolor{preprocessor}{#include <cstring>}
00068 
00069 \textcolor{preprocessor}{#include <iostream>}
00070 \textcolor{preprocessor}{#include <iomanip>}
00071 
00072 \textcolor{preprocessor}{#include <algorithm>}
00073 
00074 \textcolor{preprocessor}{#include "\hyperlink{mtk__tools_8h}{mtk\_tools.h}"}
00075 \textcolor{preprocessor}{#include "\hyperlink{mtk__dense__matrix_8h}{mtk\_dense\_matrix.h}"}
00076 \textcolor{preprocessor}{#include "\hyperlink{mtk__lapack__adapter_8h}{mtk\_lapack\_adapter.h}"}
00077 
00078 \textcolor{keyword}{namespace }\hyperlink{namespacemtk}{mtk} \{
00079 
00080 \textcolor{keyword}{extern} \textcolor{stringliteral}{"C"} \{
00081 
00082 \textcolor{preprocessor}{#ifdef MTK\_PRECISION\_DOUBLE}
00083 
00102 \textcolor{keywordtype}{void} dgesv\_(\textcolor{keywordtype}{int}* n,
00103             \textcolor{keywordtype}{int}* nrhs,
00104             \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{Real}* a,
00105             \textcolor{keywordtype}{int}* lda,
00106             \textcolor{keywordtype}{int}* ipiv,
00107             \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{Real}* b,
00108             \textcolor{keywordtype}{int}* ldb,
00109             \textcolor{keywordtype}{int}* info);
00110 \textcolor{preprocessor}{#else}
00111 
00130 \textcolor{keywordtype}{void} \hyperlink{namespacemtk_ae1d63c7ae73b3c48e0dca81eb19039f3}{sgesv\_}(\textcolor{keywordtype}{int}* n,
00131             \textcolor{keywordtype}{int}* nrhs,
00132             \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{Real}* a,
00133             \textcolor{keywordtype}{int}* lda,
00134             \textcolor{keywordtype}{int}* ipiv,
00135             \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{Real}* b,
00136             \textcolor{keywordtype}{int}* ldb,
00137             \textcolor{keywordtype}{int}* info);
00138 \textcolor{preprocessor}{#endif}
00139 
00140 \textcolor{preprocessor}{#ifdef MTK\_PRECISION\_DOUBLE}
00141 
00184 \textcolor{keywordtype}{void} dgels\_(\textcolor{keywordtype}{char}* trans,
00185             \textcolor{keywordtype}{int}* m,
00186             \textcolor{keywordtype}{int}* n,
00187             \textcolor{keywordtype}{int}* nrhs,
00188             \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{Real}* a,
00189             \textcolor{keywordtype}{int}* lda,
00190             \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{Real}* b,
00191             \textcolor{keywordtype}{int}* ldb,
00192             \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{Real}* work,
00193             \textcolor{keywordtype}{int}* lwork,
00194             \textcolor{keywordtype}{int}* info);
00195 \textcolor{preprocessor}{#else}
00196 
00239 \textcolor{keywordtype}{void} \hyperlink{namespacemtk_ada6df1b733204aa7ff0b1ec7556288f9}{sgels\_}(\textcolor{keywordtype}{char}* trans,
00240             \textcolor{keywordtype}{int}* m,
00241             \textcolor{keywordtype}{int}* n,
00242             \textcolor{keywordtype}{int}* nrhs,
00243             \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{Real}* a,
00244             \textcolor{keywordtype}{int}* lda,
00245             \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{Real}* b,
00246             \textcolor{keywordtype}{int}* ldb,
00247             \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{Real}* work,
00248             \textcolor{keywordtype}{int}* lwork,
00249             \textcolor{keywordtype}{int}* info);
00250 \textcolor{preprocessor}{#endif}
00251 
00252 \textcolor{preprocessor}{#ifdef MTK\_PRECISION\_DOUBLE}
00253 
00282 \textcolor{keywordtype}{void} dgeqrf\_(\textcolor{keywordtype}{int} *m,
00283              \textcolor{keywordtype}{int} *n,
00284              \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{Real} *a,
00285              \textcolor{keywordtype}{int} *lda,
00286              \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{Real} *tau,
00287              \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{Real} *work,
00288              \textcolor{keywordtype}{int} *lwork,
00289              \textcolor{keywordtype}{int} *info);
00290 \textcolor{preprocessor}{#else}
00291 
00320 \textcolor{keywordtype}{void} \hyperlink{namespacemtk_aece7419193d8ab43e186c97ad6d529fb}{sgeqrf\_}(\textcolor{keywordtype}{int} *m,
00321              \textcolor{keywordtype}{int} *n,
00322              \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{Real} *a,
00323              \textcolor{keywordtype}{int} *lda,
00324              \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{Real} *tau,
00325              \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{Real} *work,
00326              \textcolor{keywordtype}{int} *lwork,
00327              \textcolor{keywordtype}{int} *info);
00328 \textcolor{preprocessor}{#endif}
00329 
00330 \textcolor{preprocessor}{#ifdef MTK\_PRECISION\_DOUBLE}
00331 
00365 \textcolor{keywordtype}{void} dormqr\_(\textcolor{keywordtype}{char} *side,
00366              \textcolor{keywordtype}{char} *trans,
00367              \textcolor{keywordtype}{int} *m,
00368              \textcolor{keywordtype}{int} *n,
00369              \textcolor{keywordtype}{int} *k,
00370              \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{Real} *a,
00371              \textcolor{keywordtype}{int} *lda,
00372              \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{Real} *tau,
00373              \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{Real} *c,
00374              \textcolor{keywordtype}{int} *ldc,
00375              \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{Real} *work,
00376              \textcolor{keywordtype}{int} *lwork,
00377              \textcolor{keywordtype}{int} *info);
00378 \textcolor{preprocessor}{#else}
00379 
00413 \textcolor{keywordtype}{void} \hyperlink{namespacemtk_a59c58408e1c0a9837b67a417be986b82}{sormqr\_}(\textcolor{keywordtype}{char} *side,
00414              \textcolor{keywordtype}{char} *trans,
00415              \textcolor{keywordtype}{int} *m,
00416              \textcolor{keywordtype}{int} *n,
00417              \textcolor{keywordtype}{int} *k,
00418              \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{Real} *a,
00419              \textcolor{keywordtype}{int} *lda,
00420              \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{Real} *tau,
00421              \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{Real} *c,
00422              \textcolor{keywordtype}{int} *ldc,
00423              \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{Real} *work,
00424              \textcolor{keywordtype}{int} *lwork,
00425              \textcolor{keywordtype}{int} *info);
00426 \textcolor{preprocessor}{#endif}
00427 \}
00428 \}
00429 
\hypertarget{mtk__lapack__adapter_8cc_source_l00430}{}\hyperlink{classmtk_1_1LAPACKAdapter_a7428bccf74fd4a4af68fb7233846da22}{00430} \textcolor{keywordtype}{int} \hyperlink{classmtk_1_1LAPACKAdapter_a7428bccf74fd4a4af68fb7233846da22}{mtk::LAPACKAdapter::SolveDenseSystem}(
      \hyperlink{classmtk_1_1DenseMatrix}{mtk::DenseMatrix} &mm,
00431                                          \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{mtk::Real} *rhs) \{
00432 
00433 \textcolor{preprocessor}{  #ifdef MTK\_PERFORM\_PREVENTIONS}
00434   \hyperlink{classmtk_1_1Tools_a332324c6f25e66be9dff48c5987a3b9f}{mtk::Tools::Prevent}(rhs == \textcolor{keyword}{nullptr}, \_\_FILE\_\_, \_\_LINE\_\_, \_\_func\_\_);
00435 \textcolor{preprocessor}{  #endif}
00436 
00437   \textcolor{keywordtype}{int} *ipiv\{\};                \textcolor{comment}{// Array for pivoting information.}
00438   \textcolor{keywordtype}{int} nrhs\{1\};                \textcolor{comment}{// Number of right-hand sides.}
00439   \textcolor{keywordtype}{int} info\{\};                 \textcolor{comment}{// Status of the solution.}
00440   \textcolor{keywordtype}{int} mm\_rank\{mm.\hyperlink{classmtk_1_1DenseMatrix_a53f3afb3b6a8d21854458aaa9663cc74}{num\_rows}()\}; \textcolor{comment}{// Rank of the matrix.}
00441 
00442   \textcolor{keywordflow}{try} \{
00443     ipiv = \textcolor{keyword}{new} \textcolor{keywordtype}{int}[mm\_rank];
00444   \} \textcolor{keywordflow}{catch} (std::bad\_alloc &memory\_allocation\_exception) \{
00445     std::cerr << \textcolor{stringliteral}{"Memory allocation exception on line "} << \_\_LINE\_\_ - 3 <<
00446       std::endl;
00447     std::cerr << memory\_allocation\_exception.what() << std::endl;
00448   \}
00449   memset(ipiv, 0, \textcolor{keyword}{sizeof}(ipiv[0])*mm\_rank);
00450 
00451   \textcolor{keywordtype}{int} ldbb = mm\_rank;
00452   \textcolor{keywordtype}{int} mm\_ld = mm\_rank;
00453 
00454 \textcolor{preprocessor}{  #ifdef MTK\_PRECISION\_DOUBLE}
00455   dgesv\_(&mm\_rank, &nrhs, mm.\hyperlink{classmtk_1_1DenseMatrix_a0c33b8a9e01d157c61ddbdf807c25d84}{data}(), &mm\_ld, ipiv, rhs, &ldbb, &info);
00456 \textcolor{preprocessor}{  #else}
00457   fgesv\_(&mm\_rank, &nrhs, mm.\hyperlink{classmtk_1_1DenseMatrix_a0c33b8a9e01d157c61ddbdf807c25d84}{data}(), &mm\_ld, ipiv, rhs, &ldbb, &info);
00458 \textcolor{preprocessor}{  #endif}
00459 
00460   \textcolor{keyword}{delete} [] ipiv;
00461 
00462   \textcolor{keywordflow}{return} info;
00463 \}
00464 
\hypertarget{mtk__lapack__adapter_8cc_source_l00465}{}\hyperlink{classmtk_1_1LAPACKAdapter_af0723bba1d73450119d093b9cf1ff6f0}{00465} \textcolor{keywordtype}{int} \hyperlink{classmtk_1_1LAPACKAdapter_a7428bccf74fd4a4af68fb7233846da22}{mtk::LAPACKAdapter::SolveDenseSystem}(
      \hyperlink{classmtk_1_1DenseMatrix}{mtk::DenseMatrix} &mm,
00466                                          \hyperlink{classmtk_1_1DenseMatrix}{mtk::DenseMatrix} &bb) \{
00467 
00468   \textcolor{keywordtype}{int} nrhs\{bb.\hyperlink{classmtk_1_1DenseMatrix_a53f3afb3b6a8d21854458aaa9663cc74}{num\_rows}()\};  \textcolor{comment}{// Number of right-hand sides.}
00469 
00470 \textcolor{preprocessor}{  #ifdef MTK\_PERFORM\_PREVENTIONS}
00471   \hyperlink{classmtk_1_1Tools_a332324c6f25e66be9dff48c5987a3b9f}{mtk::Tools::Prevent}(nrhs <= 0, \_\_FILE\_\_, \_\_LINE\_\_, \_\_func\_\_);
00472 \textcolor{preprocessor}{  #endif}
00473 
00474   \textcolor{keywordtype}{int} *ipiv\{\};                \textcolor{comment}{// Array for pivoting information.}
00475   \textcolor{keywordtype}{int} info\{\};                 \textcolor{comment}{// Status of the solution.}
00476   \textcolor{keywordtype}{int} mm\_rank\{mm.\hyperlink{classmtk_1_1DenseMatrix_a53f3afb3b6a8d21854458aaa9663cc74}{num\_rows}()\}; \textcolor{comment}{// Rank of the matrix.}
00477 
00478   \textcolor{keywordflow}{try} \{
00479     ipiv = \textcolor{keyword}{new} \textcolor{keywordtype}{int}[mm\_rank];
00480   \} \textcolor{keywordflow}{catch} (std::bad\_alloc &memory\_allocation\_exception) \{
00481     std::cerr << \textcolor{stringliteral}{"Memory allocation exception on line "} << \_\_LINE\_\_ - 3 <<
00482       std::endl;
00483     std::cerr << memory\_allocation\_exception.what() << std::endl;
00484   \}
00485   memset(ipiv, 0, \textcolor{keyword}{sizeof}(ipiv[0])*mm\_rank);
00486 
00487   \textcolor{keywordtype}{int} ldbb = mm\_rank;
00488   \textcolor{keywordtype}{int} mm\_ld = mm\_rank;
00489 
00490 \textcolor{preprocessor}{  #ifdef MTK\_PRECISION\_DOUBLE}
00491   dgesv\_(&mm\_rank, &nrhs, mm.\hyperlink{classmtk_1_1DenseMatrix_a0c33b8a9e01d157c61ddbdf807c25d84}{data}(), &mm\_ld, ipiv, bb.\hyperlink{classmtk_1_1DenseMatrix_a0c33b8a9e01d157c61ddbdf807c25d84}{data}(), &ldbb, &info);
00492 \textcolor{preprocessor}{  #else}
00493   fgesv\_(&mm\_rank, &nrhs, mm.\hyperlink{classmtk_1_1DenseMatrix_a0c33b8a9e01d157c61ddbdf807c25d84}{data}(), &mm\_ld, ipiv, bb.\hyperlink{classmtk_1_1DenseMatrix_a0c33b8a9e01d157c61ddbdf807c25d84}{data}(), &ldbb, &info);
00494 \textcolor{preprocessor}{  #endif}
00495 
00496   \textcolor{keyword}{delete} [] ipiv;
00497 
00498   \textcolor{comment}{// After output, the data in the matrix will be column-major ordered.}
00499 
00500   bb.\hyperlink{classmtk_1_1DenseMatrix_a178e63f365cf8c547dc5020c60357f5e}{SetOrdering}(\hyperlink{namespacemtk_ga622801bd9f912d0f976c3e383f5f581ca7c11989c132253fb76b8f6b1314f7e13}{mtk::COL\_MAJOR});
00501 
00502 \textcolor{preprocessor}{  #if MTK\_VERBOSE\_LEVEL > 12}
00503   std::cout << \textcolor{stringliteral}{"bb\_col\_maj\_ord ="} << std::endl;
00504   std::cout << bb << std::endl;
00505 \textcolor{preprocessor}{  #endif}
00506 
00507   bb.\hyperlink{classmtk_1_1DenseMatrix_ac2949efba3e8278335d45418c85433e4}{OrderRowMajor}();
00508 
00509 \textcolor{preprocessor}{  #if MTK\_VERBOSE\_LEVEL > 12}
00510   std::cout << \textcolor{stringliteral}{"bb\_row\_maj\_ord ="} << std::endl;
00511   std::cout << bb << std::endl;
00512 \textcolor{preprocessor}{  #endif}
00513 
00514   \textcolor{keywordflow}{return} info;
00515 \}
00516 
\hypertarget{mtk__lapack__adapter_8cc_source_l00517}{}\hyperlink{classmtk_1_1LAPACKAdapter_ac38be1e30a2456b2a14c8a81f47c4ba1}{00517} \textcolor{keywordtype}{int} \hyperlink{classmtk_1_1LAPACKAdapter_a7428bccf74fd4a4af68fb7233846da22}{mtk::LAPACKAdapter::SolveDenseSystem}(
      \hyperlink{classmtk_1_1DenseMatrix}{mtk::DenseMatrix} &mm,
00518                                          \hyperlink{classmtk_1_1UniStgGrid1D}{mtk::UniStgGrid1D} &rhs) \{
00519 
00520   \textcolor{keywordtype}{int} nrhs\{1\};  \textcolor{comment}{// Number of right-hand sides.}
00521 
00522   \textcolor{keywordtype}{int} *ipiv\{\};                \textcolor{comment}{// Array for pivoting information.}
00523   \textcolor{keywordtype}{int} info\{\};                 \textcolor{comment}{// Status of the solution.}
00524   \textcolor{keywordtype}{int} mm\_rank\{mm.\hyperlink{classmtk_1_1DenseMatrix_a53f3afb3b6a8d21854458aaa9663cc74}{num\_rows}()\}; \textcolor{comment}{// Rank of the matrix.}
00525 
00526   \textcolor{keywordflow}{try} \{
00527     ipiv = \textcolor{keyword}{new} \textcolor{keywordtype}{int}[mm\_rank];
00528   \} \textcolor{keywordflow}{catch} (std::bad\_alloc &memory\_allocation\_exception) \{
00529     std::cerr << \textcolor{stringliteral}{"Memory allocation exception on line "} << \_\_LINE\_\_ - 3 <<
00530       std::endl;
00531     std::cerr << memory\_allocation\_exception.what() << std::endl;
00532   \}
00533   memset(ipiv, 0, \textcolor{keyword}{sizeof}(ipiv[0])*mm\_rank);
00534 
00535   \textcolor{keywordtype}{int} ldbb = mm\_rank;
00536   \textcolor{keywordtype}{int} mm\_ld = mm\_rank;
00537 
00538   mm.\hyperlink{classmtk_1_1DenseMatrix_a59b9bea24acf39dca64e8549b3527463}{OrderColMajor}();
00539 
00540 \textcolor{preprocessor}{  #ifdef MTK\_PRECISION\_DOUBLE}
00541   dgesv\_(&mm\_rank, &nrhs, mm.\hyperlink{classmtk_1_1DenseMatrix_a0c33b8a9e01d157c61ddbdf807c25d84}{data}(), &mm\_ld, ipiv,
00542          rhs.\hyperlink{classmtk_1_1UniStgGrid1D_ab9c3f9ee2ac76a351b01e4abfede4d19}{discrete\_field}(), &ldbb, &info);
00543 \textcolor{preprocessor}{  #else}
00544   fgesv\_(&mm\_rank, &nrhs, mm.\hyperlink{classmtk_1_1DenseMatrix_a0c33b8a9e01d157c61ddbdf807c25d84}{data}(), &mm\_ld, ipiv,
00545          rhs.\hyperlink{classmtk_1_1UniStgGrid1D_ab9c3f9ee2ac76a351b01e4abfede4d19}{discrete\_field}(), &ldbb, &info);
00546 \textcolor{preprocessor}{  #endif}
00547 
00548   mm.\hyperlink{classmtk_1_1DenseMatrix_ac2949efba3e8278335d45418c85433e4}{OrderRowMajor}();
00549 
00550   \textcolor{keyword}{delete} [] ipiv;
00551 
00552   \textcolor{keywordflow}{return} info;
00553 \}
00554 
\hypertarget{mtk__lapack__adapter_8cc_source_l00555}{}\hyperlink{classmtk_1_1LAPACKAdapter_a6c040471a1e9256bafa74e3603ff7bf5}{00555} \textcolor{keywordtype}{int} \hyperlink{classmtk_1_1LAPACKAdapter_a7428bccf74fd4a4af68fb7233846da22}{mtk::LAPACKAdapter::SolveDenseSystem}(
      \hyperlink{classmtk_1_1DenseMatrix}{mtk::DenseMatrix} &mm,
00556                                          \hyperlink{classmtk_1_1UniStgGrid2D}{mtk::UniStgGrid2D} &rhs) \{
00557 
00558   \textcolor{keywordtype}{int} nrhs\{1\};  \textcolor{comment}{// Number of right-hand sides.}
00559 
00560   \textcolor{keywordtype}{int} *ipiv\{\};                \textcolor{comment}{// Array for pivoting information.}
00561   \textcolor{keywordtype}{int} info\{\};                 \textcolor{comment}{// Status of the solution.}
00562   \textcolor{keywordtype}{int} mm\_rank\{mm.\hyperlink{classmtk_1_1DenseMatrix_a53f3afb3b6a8d21854458aaa9663cc74}{num\_rows}()\}; \textcolor{comment}{// Rank of the matrix.}
00563 
00564   \textcolor{keywordflow}{try} \{
00565     ipiv = \textcolor{keyword}{new} \textcolor{keywordtype}{int}[mm\_rank];
00566   \} \textcolor{keywordflow}{catch} (std::bad\_alloc &memory\_allocation\_exception) \{
00567     std::cerr << \textcolor{stringliteral}{"Memory allocation exception on line "} << \_\_LINE\_\_ - 3 <<
00568       std::endl;
00569     std::cerr << memory\_allocation\_exception.what() << std::endl;
00570   \}
00571   memset(ipiv, 0, \textcolor{keyword}{sizeof}(ipiv[0])*mm\_rank);
00572 
00573   \textcolor{keywordtype}{int} ldbb = mm\_rank;
00574   \textcolor{keywordtype}{int} mm\_ld = mm\_rank;
00575 
00576   mm.\hyperlink{classmtk_1_1DenseMatrix_a59b9bea24acf39dca64e8549b3527463}{OrderColMajor}();
00577 
00578 \textcolor{preprocessor}{  #ifdef MTK\_PRECISION\_DOUBLE}
00579   dgesv\_(&mm\_rank, &nrhs, mm.\hyperlink{classmtk_1_1DenseMatrix_a0c33b8a9e01d157c61ddbdf807c25d84}{data}(), &mm\_ld, ipiv,
00580          rhs.\hyperlink{classmtk_1_1UniStgGrid2D_a3e72d59843a3f9c5e47da07e5850dfe0}{discrete\_field}(), &ldbb, &info);
00581 \textcolor{preprocessor}{  #else}
00582   fgesv\_(&mm\_rank, &nrhs, mm.\hyperlink{classmtk_1_1DenseMatrix_a0c33b8a9e01d157c61ddbdf807c25d84}{data}(), &mm\_ld, ipiv,
00583          rhs.\hyperlink{classmtk_1_1UniStgGrid2D_a3e72d59843a3f9c5e47da07e5850dfe0}{discrete\_field}(), &ldbb, &info);
00584 \textcolor{preprocessor}{  #endif}
00585 
00586   mm.\hyperlink{classmtk_1_1DenseMatrix_ac2949efba3e8278335d45418c85433e4}{OrderRowMajor}();
00587 
00588   \textcolor{keyword}{delete} [] ipiv;
00589 
00590   \textcolor{keywordflow}{return} info;
00591 \}
00592 
\hypertarget{mtk__lapack__adapter_8cc_source_l00593}{}\hyperlink{classmtk_1_1LAPACKAdapter_ae5c6e78c9c819c9ac7a6f31bfd011d7a}{00593} \hyperlink{classmtk_1_1DenseMatrix}{mtk::DenseMatrix} \hyperlink{classmtk_1_1LAPACKAdapter_ae5c6e78c9c819c9ac7a6f31bfd011d7a}{mtk::LAPACKAdapter::QRFactorDenseMatrix}
      (\hyperlink{classmtk_1_1DenseMatrix}{mtk::DenseMatrix} &aa) \{
00594 
00595   \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{mtk::Real} *work\{\}; \textcolor{comment}{// Working array.}
00596   \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{mtk::Real} *tau\{\};  \textcolor{comment}{// Array for the Householder scalars.}
00597 
00598   \textcolor{comment}{// Prepare to factorize: allocate and inquire for the value of lwork.}
00599   \textcolor{keywordflow}{try} \{
00600     work = \textcolor{keyword}{new} \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{mtk::Real}[1];
00601   \} \textcolor{keywordflow}{catch} (std::bad\_alloc &memory\_allocation\_exception) \{
00602     std::cerr << \textcolor{stringliteral}{"Memory allocation exception on line "} << \_\_LINE\_\_ - 3 <<
00603       std::endl;
00604     std::cerr << memory\_allocation\_exception.what() << std::endl;
00605   \}
00606   memset(work, \hyperlink{group__c01-roots_ga59a451a5fae30d59649bcda274fea271}{mtk::kZero}, \textcolor{keyword}{sizeof}(aa.\hyperlink{classmtk_1_1DenseMatrix_a0c33b8a9e01d157c61ddbdf807c25d84}{data}()[0])*1);
00607 
00608   \textcolor{keywordtype}{int} lwork\{-1\};
00609   \textcolor{keywordtype}{int} info\{\};
00610 
00611   \textcolor{keywordtype}{int} aa\_num\_cols = aa.\hyperlink{classmtk_1_1DenseMatrix_a41747502d468c6728a4be31501b16e0e}{num\_cols}();
00612   \textcolor{keywordtype}{int} aaT\_num\_rows = aa.\hyperlink{classmtk_1_1DenseMatrix_a41747502d468c6728a4be31501b16e0e}{num\_cols}();
00613   \textcolor{keywordtype}{int} aaT\_num\_cols = aa.\hyperlink{classmtk_1_1DenseMatrix_a53f3afb3b6a8d21854458aaa9663cc74}{num\_rows}();
00614 
00615 \textcolor{preprocessor}{  #if MTK\_VERBOSE\_LEVEL > 12}
00616   std::cout << \textcolor{stringliteral}{"Input matrix BEFORE QR factorization:"} << std::endl;
00617   std::cout << aa << std::endl;
00618 \textcolor{preprocessor}{  #endif}
00619 
00620 \textcolor{preprocessor}{  #ifdef MTK\_PRECISION\_DOUBLE}
00621   dgeqrf\_(&aaT\_num\_rows, &aaT\_num\_cols, aa.\hyperlink{classmtk_1_1DenseMatrix_a0c33b8a9e01d157c61ddbdf807c25d84}{data}(), &aaT\_num\_rows,
00622           tau,
00623           work, &lwork, &info);
00624 \textcolor{preprocessor}{  #else}
00625   fgeqrf\_(&aaT\_num\_rows, &aaT\_num\_cols, aa.\hyperlink{classmtk_1_1DenseMatrix_a0c33b8a9e01d157c61ddbdf807c25d84}{data}(), &aaT\_num\_rows,
00626           tau,
00627           work, &lwork, &info);
00628 \textcolor{preprocessor}{  #endif}
00629 
00630   \textcolor{keywordflow}{if} (info == 0) \{
00631     lwork = (int) work[0];
00632   \} \textcolor{keywordflow}{else} \{
00633     std::cerr << \textcolor{stringliteral}{"Could not get value for lwork on line "} << \_\_LINE\_\_ - 5 <<
00634       std::endl;
00635     std::cerr << \textcolor{stringliteral}{"Exiting..."} << std::endl;
00636   \}
00637 
00638 \textcolor{preprocessor}{  #if MTK\_VERBOSE\_LEVEL > 10}
00639   std::cout << \textcolor{stringliteral}{"lwork = "} << std::endl << std::setw(12) << lwork << std::endl
00640     << std::endl;
00641 \textcolor{preprocessor}{  #endif}
00642 
00643   \textcolor{keyword}{delete} [] work;
00644   work = \textcolor{keyword}{nullptr};
00645 
00646   \textcolor{comment}{// Once we know lwork, we can actually invoke the factorization:}
00647   \textcolor{keywordflow}{try} \{
00648     work = \textcolor{keyword}{new} \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{mtk::Real} [lwork];
00649   \} \textcolor{keywordflow}{catch} (std::bad\_alloc &memory\_allocation\_exception) \{
00650     std::cerr << \textcolor{stringliteral}{"Memory allocation exception on line "} << \_\_LINE\_\_ - 3 <<
00651       std::endl;
00652     std::cerr << memory\_allocation\_exception.what() << std::endl;
00653   \}
00654   memset(work, \hyperlink{group__c01-roots_ga59a451a5fae30d59649bcda274fea271}{mtk::kZero}, \textcolor{keyword}{sizeof}(work[0])*lwork);
00655 
00656   \textcolor{keywordtype}{int} ltau = std::min(aaT\_num\_rows,aaT\_num\_cols);
00657 
00658   \textcolor{keywordflow}{try} \{
00659     tau = \textcolor{keyword}{new} \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{mtk::Real} [ltau];
00660   \} \textcolor{keywordflow}{catch} (std::bad\_alloc &memory\_allocation\_exception) \{
00661     std::cerr << \textcolor{stringliteral}{"Memory allocation exception on line "} << \_\_LINE\_\_ - 3 <<
00662       std::endl;
00663     std::cerr << memory\_allocation\_exception.what() << std::endl;
00664   \}
00665   memset(tau, \hyperlink{group__c01-roots_ga59a451a5fae30d59649bcda274fea271}{mtk::kZero}, \textcolor{keyword}{sizeof}(0.0)*ltau);
00666 
00667 \textcolor{preprocessor}{  #ifdef MTK\_PRECISION\_DOUBLE}
00668   dgeqrf\_(&aaT\_num\_rows, &aaT\_num\_cols, aa.\hyperlink{classmtk_1_1DenseMatrix_a0c33b8a9e01d157c61ddbdf807c25d84}{data}(), &aaT\_num\_rows,
00669           tau, work, &lwork, &info);
00670 \textcolor{preprocessor}{  #else}
00671   fgeqrf\_(&aaT\_num\_rows, &aaT\_num\_cols, aa.\hyperlink{classmtk_1_1DenseMatrix_a0c33b8a9e01d157c61ddbdf807c25d84}{data}(), &aaT\_num\_rows,
00672           tau, work, &lwork, &info);
00673 \textcolor{preprocessor}{  #endif}
00674 
00675 \textcolor{preprocessor}{  #ifdef MTK\_PERFORM\_PREVENTIONS}
00676   \textcolor{keywordflow}{if} (!info) \{
00677     std::cout << \textcolor{stringliteral}{"QR factorization completed!"} << std::endl << std::endl;
00678   \} \textcolor{keywordflow}{else} \{
00679     std::cerr << \textcolor{stringliteral}{"Error solving system! info = "} << info << std::endl;
00680     std::cerr << \textcolor{stringliteral}{"Exiting..."} << std::endl;
00681   \}
00682 \textcolor{preprocessor}{  #endif}
00683 
00684 \textcolor{preprocessor}{  #if MTK\_VERBOSE\_LEVEL > 12}
00685   std::cout << \textcolor{stringliteral}{"Input matrix AFTER QR factorization:"} << std::endl;
00686   std::cout << aa << std::endl;
00687 \textcolor{preprocessor}{  #endif}
00688 
00689   \textcolor{comment}{// We now generate the real matrix Q with orthonormal columns. This has to}
00690   \textcolor{comment}{// be done separately since the actual output of dgeqrf\_ (AA\_) represents}
00691   \textcolor{comment}{// the orthogonal matrix Q as a product of min(aa\_num\_rows,aa\_num\_cols)}
00692   \textcolor{comment}{// elementary Householder reflectors. Notice that we must re-inquire the new}
00693   \textcolor{comment}{// value for lwork that is used.}
00694 
00695   \textcolor{keywordtype}{bool} padded\{\textcolor{keyword}{false}\};
00696 
00697   \textcolor{keywordtype}{bool} transpose\{\textcolor{keyword}{false}\};
00698 
00699   \hyperlink{classmtk_1_1DenseMatrix}{mtk::DenseMatrix} QQ\_(aa.\hyperlink{classmtk_1_1DenseMatrix_a41747502d468c6728a4be31501b16e0e}{num\_cols}(),padded,transpose);
00700 
00701 \textcolor{preprocessor}{  #if MTK\_VERBOSE\_LEVEL > 12}
00702   std::cout << \textcolor{stringliteral}{"Initialized QQ\_T: "} << std::endl;
00703   std::cout << QQ\_ << std::endl;
00704 \textcolor{preprocessor}{  #endif}
00705 
00706   \textcolor{comment}{// Assemble the QQ\_ matrix:}
00707   lwork = -1;
00708 
00709   \textcolor{keyword}{delete}[] work;
00710   work = \textcolor{keyword}{nullptr};
00711 
00712   \textcolor{keywordflow}{try} \{
00713     work = \textcolor{keyword}{new} \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{mtk::Real}[1];
00714   \} \textcolor{keywordflow}{catch} (std::bad\_alloc &memory\_allocation\_exception) \{
00715     std::cerr << \textcolor{stringliteral}{"Memory allocation exception on line "} << \_\_LINE\_\_ - 3 <<
00716       std::endl;
00717     std::cerr << memory\_allocation\_exception.what() <<
00718       std::endl;
00719   \}
00720   memset(work, \hyperlink{group__c01-roots_ga59a451a5fae30d59649bcda274fea271}{mtk::kZero}, \textcolor{keyword}{sizeof}(work[0])*1);
00721 
00722   \textcolor{keywordtype}{char} side\_\{\textcolor{charliteral}{'L'}\};
00723   \textcolor{keywordtype}{char} trans\_\{\textcolor{charliteral}{'N'}\};
00724 
00725   \textcolor{keywordtype}{int} aux = QQ\_.num\_rows();
00726 
00727 \textcolor{preprocessor}{  #ifdef MTK\_PRECISION\_DOUBLE}
00728   dormqr\_(&side\_, &trans\_,
00729           &aa\_num\_cols, &aa\_num\_cols, &ltau, aa.\hyperlink{classmtk_1_1DenseMatrix_a0c33b8a9e01d157c61ddbdf807c25d84}{data}(), &aaT\_num\_rows, tau,
00730           QQ\_.data(), &aux, work, &lwork, &info);
00731 \textcolor{preprocessor}{  #else}
00732   formqr\_(&side\_, &trans\_,
00733           &aa\_num\_cols, &aa\_num\_cols, &ltau, aa.\hyperlink{classmtk_1_1DenseMatrix_a0c33b8a9e01d157c61ddbdf807c25d84}{data}(), &aaT\_num\_rows, tau,
00734           QQ\_.data(), &aux, work, &lwork, &info);
00735 \textcolor{preprocessor}{  #endif}
00736 
00737   \textcolor{keywordflow}{if} (info == 0) \{
00738     lwork = (int) work[0];
00739   \} \textcolor{keywordflow}{else} \{
00740     std::cerr << \textcolor{stringliteral}{"Could not get lwork on line "} << \_\_LINE\_\_ - 5 << std::endl;
00741     std::cerr << \textcolor{stringliteral}{"Exiting..."} << std::endl;
00742   \}
00743 
00744 \textcolor{preprocessor}{  #if MTK\_VERBOSE\_LEVEL > 10}
00745   std::cout << \textcolor{stringliteral}{"lwork = "} << std::endl << std::setw(12) << lwork <<
00746     std::endl << std::endl;
00747 \textcolor{preprocessor}{  #endif}
00748 
00749   \textcolor{keyword}{delete}[] work;
00750   work = \textcolor{keyword}{nullptr};
00751 
00752   \textcolor{keywordflow}{try} \{
00753     work = \textcolor{keyword}{new} \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{mtk::Real}[lwork];
00754   \} \textcolor{keywordflow}{catch} (std::bad\_alloc &memory\_allocation\_exception) \{
00755     std::cerr << \textcolor{stringliteral}{"Memory allocation exception on line "} << \_\_LINE\_\_ - 3 <<
00756       std::endl;
00757     std::cerr << memory\_allocation\_exception.what() << std::endl;
00758   \}
00759   memset(work, \hyperlink{group__c01-roots_ga59a451a5fae30d59649bcda274fea271}{mtk::kZero}, \textcolor{keyword}{sizeof}(work[0])*lwork);
00760 
00761 \textcolor{preprocessor}{  #ifdef MTK\_PRECISION\_DOUBLE}
00762   dormqr\_(&side\_, &trans\_,
00763           &aa\_num\_cols, &aa\_num\_cols, &ltau, aa.\hyperlink{classmtk_1_1DenseMatrix_a0c33b8a9e01d157c61ddbdf807c25d84}{data}(), &aaT\_num\_rows, tau,
00764           QQ\_.data(), &aux, work, &lwork, &info);
00765 \textcolor{preprocessor}{  #else}
00766   formqr\_(&side\_, &trans\_,
00767           &aa\_num\_cols, &aa\_num\_cols, &ltau, aa.\hyperlink{classmtk_1_1DenseMatrix_a0c33b8a9e01d157c61ddbdf807c25d84}{data}(), &aaT\_num\_rows, tau,
00768           QQ\_.data(), &aux, work, &lwork, &info);
00769 \textcolor{preprocessor}{  #endif}
00770 
00771 \textcolor{preprocessor}{  #ifdef MTK\_PERFORM\_PREVENTIONS}
00772   \textcolor{keywordflow}{if} (!info) \{
00773     std::cout << \textcolor{stringliteral}{"Q matrix successfully assembled!"} << std::endl << std::endl;
00774   \} \textcolor{keywordflow}{else} \{
00775     std::cerr << \textcolor{stringliteral}{"Something went wrong solving system! info = "} << info <<
00776       std::endl;
00777     std::cerr << \textcolor{stringliteral}{"Exiting..."} << std::endl;
00778   \}
00779 \textcolor{preprocessor}{  #endif}
00780 
00781   \textcolor{keyword}{delete}[] work;
00782   work = \textcolor{keyword}{nullptr};
00783 
00784   \textcolor{keyword}{delete}[] tau;
00785   tau = \textcolor{keyword}{nullptr};
00786 
00787   \textcolor{keywordflow}{return} QQ\_;
00788 \}
00789 
\hypertarget{mtk__lapack__adapter_8cc_source_l00790}{}\hyperlink{classmtk_1_1LAPACKAdapter_a380f148ffdf96bae2f79ae28f1a6560c}{00790} \textcolor{keywordtype}{int} \hyperlink{classmtk_1_1LAPACKAdapter_a380f148ffdf96bae2f79ae28f1a6560c}{mtk::LAPACKAdapter::SolveRectangularDenseSystem}(\textcolor{keyword}{const} 
      \hyperlink{classmtk_1_1DenseMatrix}{mtk::DenseMatrix} &aa,
00791                                                    \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{mtk::Real} *ob\_,
00792                                                    \textcolor{keywordtype}{int} ob\_ld\_) \{
00793 
00794   \textcolor{comment}{// We first invoke the solver to query for the value of lwork. For this,}
00795   \textcolor{comment}{// we must at least allocate enough space to allow access to WORK(1), or}
00796   \textcolor{comment}{// work[0]:}
00797 
00798   \textcolor{comment}{// If LWORK = -1, then a workspace query is assumed; the routine only}
00799   \textcolor{comment}{// calculates the optimal size of the WORK array, returns this value as}
00800   \textcolor{comment}{// the first entry of the WORK array, and no error message related to}
00801   \textcolor{comment}{// LWORK is issued by XERBLA.}
00802 
00803   \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{mtk::Real} *work\{\}; \textcolor{comment}{// Work array.}
00804 
00805   \textcolor{keywordflow}{try} \{
00806     work = \textcolor{keyword}{new} \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{mtk::Real}[1];
00807   \} \textcolor{keywordflow}{catch} (std::bad\_alloc &memory\_allocation\_exception) \{
00808     std::cerr << \textcolor{stringliteral}{"Memory allocation exception on line "} << \_\_LINE\_\_ - 3 <<
00809       std::endl;
00810     std::cerr << memory\_allocation\_exception.what() << std::endl;
00811   \}
00812   memset(work, \hyperlink{group__c01-roots_ga59a451a5fae30d59649bcda274fea271}{mtk::kZero}, \textcolor{keyword}{sizeof}(work[0])*1);
00813 
00814   \textcolor{keywordtype}{char} trans\_\{\textcolor{charliteral}{'N'}\};
00815   \textcolor{keywordtype}{int} nrhs\_\{1\};
00816   \textcolor{keywordtype}{int} info\{0\};
00817   \textcolor{keywordtype}{int} lwork\{-1\};
00818 
00819   \textcolor{keywordtype}{int} AA\_num\_rows\_  = aa.\hyperlink{classmtk_1_1DenseMatrix_a41747502d468c6728a4be31501b16e0e}{num\_cols}();
00820   \textcolor{keywordtype}{int} AA\_num\_cols\_  = aa.\hyperlink{classmtk_1_1DenseMatrix_a53f3afb3b6a8d21854458aaa9663cc74}{num\_rows}();
00821   \textcolor{keywordtype}{int} AA\_ld\_ = std::max(1,aa.\hyperlink{classmtk_1_1DenseMatrix_a41747502d468c6728a4be31501b16e0e}{num\_cols}());
00822 
00823 \textcolor{preprocessor}{  #ifdef MTK\_PRECISION\_DOUBLE}
00824   dgels\_(&trans\_, &AA\_num\_rows\_, &AA\_num\_cols\_, &nrhs\_, aa.\hyperlink{classmtk_1_1DenseMatrix_a0c33b8a9e01d157c61ddbdf807c25d84}{data}(), &AA\_ld\_,
00825          ob\_, &ob\_ld\_,
00826          work, &lwork, &info);
00827 \textcolor{preprocessor}{  #else}
00828   \hyperlink{namespacemtk_ada6df1b733204aa7ff0b1ec7556288f9}{sgels\_}(&trans\_, &AA\_num\_rows\_, &AA\_num\_cols\_, &nrhs\_, aa.\hyperlink{classmtk_1_1DenseMatrix_a0c33b8a9e01d157c61ddbdf807c25d84}{data}(), &AA\_ld\_,
00829          ob\_, &ob\_ld\_,
00830          work, &lwork, &info);
00831 \textcolor{preprocessor}{  #endif}
00832 
00833   \textcolor{keywordflow}{if} (info == 0) \{
00834     lwork = (int) work[0];
00835   \} \textcolor{keywordflow}{else} \{
00836     std::cerr << \textcolor{stringliteral}{"Could not get value for lwork on line "} << \_\_LINE\_\_ - 2 <<
00837       std::endl;
00838     std::cerr << \textcolor{stringliteral}{"Exiting..."} << std::endl;
00839     \textcolor{keywordflow}{return} info;
00840   \}
00841 
00842 \textcolor{preprocessor}{  #if MTK\_VERBOSE\_LEVEL > 10}
00843   std::cout << \textcolor{stringliteral}{"lwork = "} << std::endl << std::setw(12)<< lwork <<
00844     std::endl << std::endl;
00845 \textcolor{preprocessor}{  #endif}
00846 
00847   \textcolor{comment}{// We then use lwork's new value to create the work array:}
00848   \textcolor{keyword}{delete}[] work;
00849   work = \textcolor{keyword}{nullptr};
00850 
00851   \textcolor{keywordflow}{try} \{
00852     work = \textcolor{keyword}{new} \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{mtk::Real}[lwork];
00853   \} \textcolor{keywordflow}{catch} (std::bad\_alloc &memory\_allocation\_exception) \{
00854     std::cerr << \textcolor{stringliteral}{"Memory allocation exception on line "} << \_\_LINE\_\_ - 3 << std::endl;
00855     std::cerr << memory\_allocation\_exception.what() << std::endl;
00856   \}
00857   memset(work, 0.0, \textcolor{keyword}{sizeof}(work[0])*lwork);
00858 
00859   \textcolor{comment}{// We now invoke the solver again:}
00860 \textcolor{preprocessor}{  #ifdef MTK\_PRECISION\_DOUBLE}
00861   dgels\_(&trans\_, &AA\_num\_rows\_, &AA\_num\_cols\_, &nrhs\_, aa.\hyperlink{classmtk_1_1DenseMatrix_a0c33b8a9e01d157c61ddbdf807c25d84}{data}(), &AA\_ld\_,
00862          ob\_, &ob\_ld\_,
00863          work, &lwork, &info);
00864 \textcolor{preprocessor}{  #else}
00865   \hyperlink{namespacemtk_ada6df1b733204aa7ff0b1ec7556288f9}{sgels\_}(&trans\_, &AA\_num\_rows\_, &AA\_num\_cols\_, &nrhs\_, aa.\hyperlink{classmtk_1_1DenseMatrix_a0c33b8a9e01d157c61ddbdf807c25d84}{data}(), &AA\_ld\_,
00866          ob\_, &ob\_ld\_,
00867          work, &lwork, &info);
00868 \textcolor{preprocessor}{  #endif}
00869 
00870   \textcolor{keyword}{delete} [] work;
00871   work = \textcolor{keyword}{nullptr};
00872 
00873   \textcolor{keywordflow}{return} info;
00874 \}
\end{DoxyCode}
