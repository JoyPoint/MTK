\hypertarget{mtk__lapack__adapter_8cc_source}{\section{mtk\+\_\+lapack\+\_\+adapter.\+cc}
\label{mtk__lapack__adapter_8cc_source}\index{src/mtk\+\_\+lapack\+\_\+adapter.\+cc@{src/mtk\+\_\+lapack\+\_\+adapter.\+cc}}
}

\begin{DoxyCode}
00001 
00022 \textcolor{comment}{/*}
00023 \textcolor{comment}{Copyright (C) 2015, Computational Science Research Center, San Diego State}
00024 \textcolor{comment}{University. All rights reserved.}
00025 \textcolor{comment}{}
00026 \textcolor{comment}{Redistribution and use in source and binary forms, with or without modification,}
00027 \textcolor{comment}{are permitted provided that the following conditions are met:}
00028 \textcolor{comment}{}
00029 \textcolor{comment}{1. Modifications to source code should be reported to: esanchez@mail.sdsu.edu}
00030 \textcolor{comment}{and a copy of the modified files should be reported once modifications are}
00031 \textcolor{comment}{completed, unless these modifications are made through the project's GitHub}
00032 \textcolor{comment}{page: http://www.csrc.sdsu.edu/mtk. Documentation related to said modifications}
00033 \textcolor{comment}{should be developed and included in any deliverable.}
00034 \textcolor{comment}{}
00035 \textcolor{comment}{2. Redistributions of source code must be done through direct}
00036 \textcolor{comment}{downloads from the project's GitHub page: http://www.csrc.sdsu.edu/mtk}
00037 \textcolor{comment}{}
00038 \textcolor{comment}{3. Redistributions in binary form must reproduce the above copyright notice,}
00039 \textcolor{comment}{this list of conditions and the following disclaimer in the documentation and/or}
00040 \textcolor{comment}{other materials provided with the distribution.}
00041 \textcolor{comment}{}
00042 \textcolor{comment}{4. Usage of the binary form on proprietary applications shall require explicit}
00043 \textcolor{comment}{prior written permission from the the copyright holders, and due credit should}
00044 \textcolor{comment}{be given to the copyright holders.}
00045 \textcolor{comment}{}
00046 \textcolor{comment}{5. Neither the name of the copyright holder nor the names of its contributors}
00047 \textcolor{comment}{may be used to endorse or promote products derived from this software without}
00048 \textcolor{comment}{specific prior written permission.}
00049 \textcolor{comment}{}
00050 \textcolor{comment}{The copyright holders provide no reassurances that the source code provided does}
00051 \textcolor{comment}{not infringe any patent, copyright, or any other intellectual property rights of}
00052 \textcolor{comment}{third parties. The copyright holders disclaim any liability to any recipient for}
00053 \textcolor{comment}{claims brought against recipient by any third party for infringement of that}
00054 \textcolor{comment}{parties intellectual property rights.}
00055 \textcolor{comment}{}
00056 \textcolor{comment}{THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND}
00057 \textcolor{comment}{ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED}
00058 \textcolor{comment}{WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE}
00059 \textcolor{comment}{DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR}
00060 \textcolor{comment}{ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES}
00061 \textcolor{comment}{(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;}
00062 \textcolor{comment}{LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON}
00063 \textcolor{comment}{ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT}
00064 \textcolor{comment}{(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS}
00065 \textcolor{comment}{SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.}
00066 \textcolor{comment}{*/}
00067 
00068 \textcolor{preprocessor}{#include <cstring>}
00069 
00070 \textcolor{preprocessor}{#include <iostream>}
00071 \textcolor{preprocessor}{#include <iomanip>}
00072 
00073 \textcolor{preprocessor}{#include <algorithm>}
00074 
00075 \textcolor{preprocessor}{#include "\hyperlink{mtk__tools_8h}{mtk\_tools.h}"}
00076 \textcolor{preprocessor}{#include "\hyperlink{mtk__dense__matrix_8h}{mtk\_dense\_matrix.h}"}
00077 \textcolor{preprocessor}{#include "\hyperlink{mtk__lapack__adapter_8h}{mtk\_lapack\_adapter.h}"}
00078 
00079 \textcolor{keyword}{namespace }\hyperlink{namespacemtk}{mtk} \{
00080 
00081 \textcolor{keyword}{extern} \textcolor{stringliteral}{"C"} \{
00082 
00083 \textcolor{preprocessor}{#ifdef MTK\_PRECISION\_DOUBLE}
00084 
00103 \textcolor{keywordtype}{void} dgesv\_(\textcolor{keywordtype}{int}* n,
00104             \textcolor{keywordtype}{int}* nrhs,
00105             \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{Real}* a,
00106             \textcolor{keywordtype}{int}* lda,
00107             \textcolor{keywordtype}{int}* ipiv,
00108             \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{Real}* b,
00109             \textcolor{keywordtype}{int}* ldb,
00110             \textcolor{keywordtype}{int}* info);
00111 \textcolor{preprocessor}{#else}
00112 
00131 \textcolor{keywordtype}{void} \hyperlink{namespacemtk_ae1d63c7ae73b3c48e0dca81eb19039f3}{sgesv\_}(\textcolor{keywordtype}{int}* n,
00132             \textcolor{keywordtype}{int}* nrhs,
00133             \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{Real}* a,
00134             \textcolor{keywordtype}{int}* lda,
00135             \textcolor{keywordtype}{int}* ipiv,
00136             \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{Real}* b,
00137             \textcolor{keywordtype}{int}* ldb,
00138             \textcolor{keywordtype}{int}* info);
00139 \textcolor{preprocessor}{#endif}
00140 
00141 \textcolor{preprocessor}{#ifdef MTK\_PRECISION\_DOUBLE}
00142 
00185 \textcolor{keywordtype}{void} dgels\_(\textcolor{keywordtype}{char}* trans,
00186             \textcolor{keywordtype}{int}* m,
00187             \textcolor{keywordtype}{int}* n,
00188             \textcolor{keywordtype}{int}* nrhs,
00189             \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{Real}* a,
00190             \textcolor{keywordtype}{int}* lda,
00191             \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{Real}* b,
00192             \textcolor{keywordtype}{int}* ldb,
00193             \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{Real}* work,
00194             \textcolor{keywordtype}{int}* lwork,
00195             \textcolor{keywordtype}{int}* info);
00196 \textcolor{preprocessor}{#else}
00197 
00240 \textcolor{keywordtype}{void} \hyperlink{namespacemtk_ada6df1b733204aa7ff0b1ec7556288f9}{sgels\_}(\textcolor{keywordtype}{char}* trans,
00241             \textcolor{keywordtype}{int}* m,
00242             \textcolor{keywordtype}{int}* n,
00243             \textcolor{keywordtype}{int}* nrhs,
00244             \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{Real}* a,
00245             \textcolor{keywordtype}{int}* lda,
00246             \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{Real}* b,
00247             \textcolor{keywordtype}{int}* ldb,
00248             \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{Real}* work,
00249             \textcolor{keywordtype}{int}* lwork,
00250             \textcolor{keywordtype}{int}* info);
00251 \textcolor{preprocessor}{#endif}
00252 
00253 \textcolor{preprocessor}{#ifdef MTK\_PRECISION\_DOUBLE}
00254 
00283 \textcolor{keywordtype}{void} dgeqrf\_(\textcolor{keywordtype}{int} *m,
00284              \textcolor{keywordtype}{int} *n,
00285              \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{Real} *a,
00286              \textcolor{keywordtype}{int} *lda,
00287              \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{Real} *tau,
00288              \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{Real} *work,
00289              \textcolor{keywordtype}{int} *lwork,
00290              \textcolor{keywordtype}{int} *info);
00291 \textcolor{preprocessor}{#else}
00292 
00321 \textcolor{keywordtype}{void} \hyperlink{namespacemtk_aece7419193d8ab43e186c97ad6d529fb}{sgeqrf\_}(\textcolor{keywordtype}{int} *m,
00322              \textcolor{keywordtype}{int} *n,
00323              \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{Real} *a,
00324              \textcolor{keywordtype}{int} *lda,
00325              \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{Real} *tau,
00326              \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{Real} *work,
00327              \textcolor{keywordtype}{int} *lwork,
00328              \textcolor{keywordtype}{int} *info);
00329 \textcolor{preprocessor}{#endif}
00330 
00331 \textcolor{preprocessor}{#ifdef MTK\_PRECISION\_DOUBLE}
00332 
00366 \textcolor{keywordtype}{void} dormqr\_(\textcolor{keywordtype}{char} *side,
00367              \textcolor{keywordtype}{char} *trans,
00368              \textcolor{keywordtype}{int} *m,
00369              \textcolor{keywordtype}{int} *n,
00370              \textcolor{keywordtype}{int} *k,
00371              \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{Real} *a,
00372              \textcolor{keywordtype}{int} *lda,
00373              \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{Real} *tau,
00374              \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{Real} *c,
00375              \textcolor{keywordtype}{int} *ldc,
00376              \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{Real} *work,
00377              \textcolor{keywordtype}{int} *lwork,
00378              \textcolor{keywordtype}{int} *info);
00379 \textcolor{preprocessor}{#else}
00380 
00414 \textcolor{keywordtype}{void} \hyperlink{namespacemtk_a59c58408e1c0a9837b67a417be986b82}{sormqr\_}(\textcolor{keywordtype}{char} *side,
00415              \textcolor{keywordtype}{char} *trans,
00416              \textcolor{keywordtype}{int} *m,
00417              \textcolor{keywordtype}{int} *n,
00418              \textcolor{keywordtype}{int} *k,
00419              \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{Real} *a,
00420              \textcolor{keywordtype}{int} *lda,
00421              \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{Real} *tau,
00422              \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{Real} *c,
00423              \textcolor{keywordtype}{int} *ldc,
00424              \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{Real} *work,
00425              \textcolor{keywordtype}{int} *lwork,
00426              \textcolor{keywordtype}{int} *info);
00427 \textcolor{preprocessor}{#endif}
00428 \}
00429 \}
00430 
\hypertarget{mtk__lapack__adapter_8cc_source_l00431}{}\hyperlink{classmtk_1_1LAPACKAdapter_a7428bccf74fd4a4af68fb7233846da22}{00431} \textcolor{keywordtype}{int} \hyperlink{classmtk_1_1LAPACKAdapter_a7428bccf74fd4a4af68fb7233846da22}{mtk::LAPACKAdapter::SolveDenseSystem}(
      \hyperlink{classmtk_1_1DenseMatrix}{mtk::DenseMatrix} &mm,
00432                                          \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{mtk::Real} *rhs) \{
00433 
00434 \textcolor{preprocessor}{  #ifdef MTK\_PERFORM\_PREVENTIONS}
00435   \hyperlink{classmtk_1_1Tools_a332324c6f25e66be9dff48c5987a3b9f}{mtk::Tools::Prevent}(rhs == \textcolor{keyword}{nullptr}, \_\_FILE\_\_, \_\_LINE\_\_, \_\_func\_\_);
00436 \textcolor{preprocessor}{  #endif}
00437 
00438   \textcolor{keywordtype}{int} *ipiv\{\};                \textcolor{comment}{// Array for pivoting information.}
00439   \textcolor{keywordtype}{int} nrhs\{1\};                \textcolor{comment}{// Number of right-hand sides.}
00440   \textcolor{keywordtype}{int} info\{\};                 \textcolor{comment}{// Status of the solution.}
00441   \textcolor{keywordtype}{int} mm\_rank\{mm.\hyperlink{classmtk_1_1DenseMatrix_a53f3afb3b6a8d21854458aaa9663cc74}{num\_rows}()\}; \textcolor{comment}{// Rank of the matrix.}
00442 
00443   \textcolor{keywordflow}{try} \{
00444     ipiv = \textcolor{keyword}{new} \textcolor{keywordtype}{int}[mm\_rank];
00445   \} \textcolor{keywordflow}{catch} (std::bad\_alloc &memory\_allocation\_exception) \{
00446     std::cerr << \textcolor{stringliteral}{"Memory allocation exception on line "} << \_\_LINE\_\_ - 3 <<
00447       std::endl;
00448     std::cerr << memory\_allocation\_exception.what() << std::endl;
00449   \}
00450   memset(ipiv, 0, \textcolor{keyword}{sizeof}(ipiv[0])*mm\_rank);
00451 
00452   \textcolor{keywordtype}{int} ldbb = mm\_rank;
00453   \textcolor{keywordtype}{int} mm\_ld = mm\_rank;
00454 
00455 \textcolor{preprocessor}{  #ifdef MTK\_PRECISION\_DOUBLE}
00456   dgesv\_(&mm\_rank, &nrhs, mm.\hyperlink{classmtk_1_1DenseMatrix_a0c33b8a9e01d157c61ddbdf807c25d84}{data}(), &mm\_ld, ipiv, rhs, &ldbb, &info);
00457 \textcolor{preprocessor}{  #else}
00458   fgesv\_(&mm\_rank, &nrhs, mm.\hyperlink{classmtk_1_1DenseMatrix_a0c33b8a9e01d157c61ddbdf807c25d84}{data}(), &mm\_ld, ipiv, rhs, &ldbb, &info);
00459 \textcolor{preprocessor}{  #endif}
00460 
00461   \textcolor{keyword}{delete} [] ipiv;
00462 
00463   \textcolor{keywordflow}{return} info;
00464 \}
00465 
\hypertarget{mtk__lapack__adapter_8cc_source_l00466}{}\hyperlink{classmtk_1_1LAPACKAdapter_af0723bba1d73450119d093b9cf1ff6f0}{00466} \textcolor{keywordtype}{int} \hyperlink{classmtk_1_1LAPACKAdapter_a7428bccf74fd4a4af68fb7233846da22}{mtk::LAPACKAdapter::SolveDenseSystem}(
      \hyperlink{classmtk_1_1DenseMatrix}{mtk::DenseMatrix} &mm,
00467                                          \hyperlink{classmtk_1_1DenseMatrix}{mtk::DenseMatrix} &bb) \{
00468 
00469   \textcolor{keywordtype}{int} nrhs\{bb.\hyperlink{classmtk_1_1DenseMatrix_a53f3afb3b6a8d21854458aaa9663cc74}{num\_rows}()\};  \textcolor{comment}{// Number of right-hand sides.}
00470 
00471 \textcolor{preprocessor}{  #ifdef MTK\_PERFORM\_PREVENTIONS}
00472   \hyperlink{classmtk_1_1Tools_a332324c6f25e66be9dff48c5987a3b9f}{mtk::Tools::Prevent}(nrhs <= 0, \_\_FILE\_\_, \_\_LINE\_\_, \_\_func\_\_);
00473 \textcolor{preprocessor}{  #endif}
00474 
00475   \textcolor{keywordtype}{int} *ipiv\{\};                \textcolor{comment}{// Array for pivoting information.}
00476   \textcolor{keywordtype}{int} info\{\};                 \textcolor{comment}{// Status of the solution.}
00477   \textcolor{keywordtype}{int} mm\_rank\{mm.\hyperlink{classmtk_1_1DenseMatrix_a53f3afb3b6a8d21854458aaa9663cc74}{num\_rows}()\}; \textcolor{comment}{// Rank of the matrix.}
00478 
00479   \textcolor{keywordflow}{try} \{
00480     ipiv = \textcolor{keyword}{new} \textcolor{keywordtype}{int}[mm\_rank];
00481   \} \textcolor{keywordflow}{catch} (std::bad\_alloc &memory\_allocation\_exception) \{
00482     std::cerr << \textcolor{stringliteral}{"Memory allocation exception on line "} << \_\_LINE\_\_ - 3 <<
00483       std::endl;
00484     std::cerr << memory\_allocation\_exception.what() << std::endl;
00485   \}
00486   memset(ipiv, 0, \textcolor{keyword}{sizeof}(ipiv[0])*mm\_rank);
00487 
00488   \textcolor{keywordtype}{int} ldbb = mm\_rank;
00489   \textcolor{keywordtype}{int} mm\_ld = mm\_rank;
00490 
00491 \textcolor{preprocessor}{  #ifdef MTK\_PRECISION\_DOUBLE}
00492   dgesv\_(&mm\_rank, &nrhs, mm.\hyperlink{classmtk_1_1DenseMatrix_a0c33b8a9e01d157c61ddbdf807c25d84}{data}(), &mm\_ld, ipiv, bb.\hyperlink{classmtk_1_1DenseMatrix_a0c33b8a9e01d157c61ddbdf807c25d84}{data}(), &ldbb, &info);
00493 \textcolor{preprocessor}{  #else}
00494   fgesv\_(&mm\_rank, &nrhs, mm.\hyperlink{classmtk_1_1DenseMatrix_a0c33b8a9e01d157c61ddbdf807c25d84}{data}(), &mm\_ld, ipiv, bb.\hyperlink{classmtk_1_1DenseMatrix_a0c33b8a9e01d157c61ddbdf807c25d84}{data}(), &ldbb, &info);
00495 \textcolor{preprocessor}{  #endif}
00496 
00497   \textcolor{keyword}{delete} [] ipiv;
00498 
00499   \textcolor{comment}{// After output, the data in the matrix will be column-major ordered.}
00500 
00501   bb.\hyperlink{classmtk_1_1DenseMatrix_a178e63f365cf8c547dc5020c60357f5e}{SetOrdering}(\hyperlink{namespacemtk_ga622801bd9f912d0f976c3e383f5f581ca34d2765ffc490951febdcca04bc4f7cd}{mtk::MatrixOrdering::COL\_MAJOR});
00502 
00503 \textcolor{preprocessor}{  #if MTK\_VERBOSE\_LEVEL > 12}
00504   std::cout << \textcolor{stringliteral}{"bb\_col\_maj\_ord ="} << std::endl;
00505   std::cout << bb << std::endl;
00506 \textcolor{preprocessor}{  #endif}
00507 
00508   bb.\hyperlink{classmtk_1_1DenseMatrix_ac2949efba3e8278335d45418c85433e4}{OrderRowMajor}();
00509 
00510 \textcolor{preprocessor}{  #if MTK\_VERBOSE\_LEVEL > 12}
00511   std::cout << \textcolor{stringliteral}{"bb\_row\_maj\_ord ="} << std::endl;
00512   std::cout << bb << std::endl;
00513 \textcolor{preprocessor}{  #endif}
00514 
00515   \textcolor{keywordflow}{return} info;
00516 \}
00517 
\hypertarget{mtk__lapack__adapter_8cc_source_l00518}{}\hyperlink{classmtk_1_1LAPACKAdapter_ac38be1e30a2456b2a14c8a81f47c4ba1}{00518} \textcolor{keywordtype}{int} \hyperlink{classmtk_1_1LAPACKAdapter_a7428bccf74fd4a4af68fb7233846da22}{mtk::LAPACKAdapter::SolveDenseSystem}(
      \hyperlink{classmtk_1_1DenseMatrix}{mtk::DenseMatrix} &mm,
00519                                          \hyperlink{classmtk_1_1UniStgGrid1D}{mtk::UniStgGrid1D} &rhs) \{
00520 
00521   \textcolor{keywordtype}{int} nrhs\{1\};  \textcolor{comment}{// Number of right-hand sides.}
00522 
00523   \textcolor{keywordtype}{int} *ipiv\{\};                \textcolor{comment}{// Array for pivoting information.}
00524   \textcolor{keywordtype}{int} info\{\};                 \textcolor{comment}{// Status of the solution.}
00525   \textcolor{keywordtype}{int} mm\_rank\{mm.\hyperlink{classmtk_1_1DenseMatrix_a53f3afb3b6a8d21854458aaa9663cc74}{num\_rows}()\}; \textcolor{comment}{// Rank of the matrix.}
00526 
00527   \textcolor{keywordflow}{try} \{
00528     ipiv = \textcolor{keyword}{new} \textcolor{keywordtype}{int}[mm\_rank];
00529   \} \textcolor{keywordflow}{catch} (std::bad\_alloc &memory\_allocation\_exception) \{
00530     std::cerr << \textcolor{stringliteral}{"Memory allocation exception on line "} << \_\_LINE\_\_ - 3 <<
00531       std::endl;
00532     std::cerr << memory\_allocation\_exception.what() << std::endl;
00533   \}
00534   memset(ipiv, 0, \textcolor{keyword}{sizeof}(ipiv[0])*mm\_rank);
00535 
00536   \textcolor{keywordtype}{int} ldbb = mm\_rank;
00537   \textcolor{keywordtype}{int} mm\_ld = mm\_rank;
00538 
00539   mm.\hyperlink{classmtk_1_1DenseMatrix_a59b9bea24acf39dca64e8549b3527463}{OrderColMajor}();
00540 
00541 \textcolor{preprocessor}{  #ifdef MTK\_PRECISION\_DOUBLE}
00542   dgesv\_(&mm\_rank, &nrhs, mm.\hyperlink{classmtk_1_1DenseMatrix_a0c33b8a9e01d157c61ddbdf807c25d84}{data}(), &mm\_ld, ipiv,
00543          rhs.\hyperlink{classmtk_1_1UniStgGrid1D_ab9c3f9ee2ac76a351b01e4abfede4d19}{discrete\_field}(), &ldbb, &info);
00544 \textcolor{preprocessor}{  #else}
00545   fgesv\_(&mm\_rank, &nrhs, mm.\hyperlink{classmtk_1_1DenseMatrix_a0c33b8a9e01d157c61ddbdf807c25d84}{data}(), &mm\_ld, ipiv,
00546          rhs.\hyperlink{classmtk_1_1UniStgGrid1D_ab9c3f9ee2ac76a351b01e4abfede4d19}{discrete\_field}(), &ldbb, &info);
00547 \textcolor{preprocessor}{  #endif}
00548 
00549   mm.\hyperlink{classmtk_1_1DenseMatrix_ac2949efba3e8278335d45418c85433e4}{OrderRowMajor}();
00550 
00551   \textcolor{keyword}{delete} [] ipiv;
00552 
00553   \textcolor{keywordflow}{return} info;
00554 \}
00555 
\hypertarget{mtk__lapack__adapter_8cc_source_l00556}{}\hyperlink{classmtk_1_1LAPACKAdapter_a6c040471a1e9256bafa74e3603ff7bf5}{00556} \textcolor{keywordtype}{int} \hyperlink{classmtk_1_1LAPACKAdapter_a7428bccf74fd4a4af68fb7233846da22}{mtk::LAPACKAdapter::SolveDenseSystem}(
      \hyperlink{classmtk_1_1DenseMatrix}{mtk::DenseMatrix} &mm,
00557                                          \hyperlink{classmtk_1_1UniStgGrid2D}{mtk::UniStgGrid2D} &rhs) \{
00558 
00559   \textcolor{keywordtype}{int} nrhs\{1\};  \textcolor{comment}{// Number of right-hand sides.}
00560 
00561   \textcolor{keywordtype}{int} *ipiv\{\};                \textcolor{comment}{// Array for pivoting information.}
00562   \textcolor{keywordtype}{int} info\{\};                 \textcolor{comment}{// Status of the solution.}
00563   \textcolor{keywordtype}{int} mm\_rank\{mm.\hyperlink{classmtk_1_1DenseMatrix_a53f3afb3b6a8d21854458aaa9663cc74}{num\_rows}()\}; \textcolor{comment}{// Rank of the matrix.}
00564 
00565   \textcolor{keywordflow}{try} \{
00566     ipiv = \textcolor{keyword}{new} \textcolor{keywordtype}{int}[mm\_rank];
00567   \} \textcolor{keywordflow}{catch} (std::bad\_alloc &memory\_allocation\_exception) \{
00568     std::cerr << \textcolor{stringliteral}{"Memory allocation exception on line "} << \_\_LINE\_\_ - 3 <<
00569       std::endl;
00570     std::cerr << memory\_allocation\_exception.what() << std::endl;
00571   \}
00572   memset(ipiv, 0, \textcolor{keyword}{sizeof}(ipiv[0])*mm\_rank);
00573 
00574   \textcolor{keywordtype}{int} ldbb = mm\_rank;
00575   \textcolor{keywordtype}{int} mm\_ld = mm\_rank;
00576 
00577   mm.\hyperlink{classmtk_1_1DenseMatrix_a59b9bea24acf39dca64e8549b3527463}{OrderColMajor}();
00578 
00579 \textcolor{preprocessor}{  #ifdef MTK\_PRECISION\_DOUBLE}
00580   dgesv\_(&mm\_rank, &nrhs, mm.\hyperlink{classmtk_1_1DenseMatrix_a0c33b8a9e01d157c61ddbdf807c25d84}{data}(), &mm\_ld, ipiv,
00581          rhs.\hyperlink{classmtk_1_1UniStgGrid2D_a3e72d59843a3f9c5e47da07e5850dfe0}{discrete\_field}(), &ldbb, &info);
00582 \textcolor{preprocessor}{  #else}
00583   fgesv\_(&mm\_rank, &nrhs, mm.\hyperlink{classmtk_1_1DenseMatrix_a0c33b8a9e01d157c61ddbdf807c25d84}{data}(), &mm\_ld, ipiv,
00584          rhs.\hyperlink{classmtk_1_1UniStgGrid2D_a3e72d59843a3f9c5e47da07e5850dfe0}{discrete\_field}(), &ldbb, &info);
00585 \textcolor{preprocessor}{  #endif}
00586 
00587   mm.\hyperlink{classmtk_1_1DenseMatrix_ac2949efba3e8278335d45418c85433e4}{OrderRowMajor}();
00588 
00589   \textcolor{keyword}{delete} [] ipiv;
00590 
00591   \textcolor{keywordflow}{return} info;
00592 \}
00593 
\hypertarget{mtk__lapack__adapter_8cc_source_l00594}{}\hyperlink{classmtk_1_1LAPACKAdapter_ae5c6e78c9c819c9ac7a6f31bfd011d7a}{00594} \hyperlink{classmtk_1_1DenseMatrix}{mtk::DenseMatrix} \hyperlink{classmtk_1_1LAPACKAdapter_ae5c6e78c9c819c9ac7a6f31bfd011d7a}{mtk::LAPACKAdapter::QRFactorDenseMatrix}
      (\hyperlink{classmtk_1_1DenseMatrix}{mtk::DenseMatrix} &aa) \{
00595 
00596   \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{mtk::Real} *work\{\}; \textcolor{comment}{// Working array.}
00597   \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{mtk::Real} *tau\{\};  \textcolor{comment}{// Array for the Householder scalars.}
00598 
00599   \textcolor{comment}{// Prepare to factorize: allocate and inquire for the value of lwork.}
00600   \textcolor{keywordflow}{try} \{
00601     work = \textcolor{keyword}{new} \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{mtk::Real}[1];
00602   \} \textcolor{keywordflow}{catch} (std::bad\_alloc &memory\_allocation\_exception) \{
00603     std::cerr << \textcolor{stringliteral}{"Memory allocation exception on line "} << \_\_LINE\_\_ - 3 <<
00604       std::endl;
00605     std::cerr << memory\_allocation\_exception.what() << std::endl;
00606   \}
00607   memset(work, \hyperlink{group__c01-roots_ga59a451a5fae30d59649bcda274fea271}{mtk::kZero}, \textcolor{keyword}{sizeof}(aa.\hyperlink{classmtk_1_1DenseMatrix_a0c33b8a9e01d157c61ddbdf807c25d84}{data}()[0])*1);
00608 
00609   \textcolor{keywordtype}{int} lwork\{-1\};
00610   \textcolor{keywordtype}{int} info\{\};
00611 
00612   \textcolor{keywordtype}{int} aa\_num\_cols = aa.\hyperlink{classmtk_1_1DenseMatrix_a41747502d468c6728a4be31501b16e0e}{num\_cols}();
00613   \textcolor{keywordtype}{int} aaT\_num\_rows = aa.\hyperlink{classmtk_1_1DenseMatrix_a41747502d468c6728a4be31501b16e0e}{num\_cols}();
00614   \textcolor{keywordtype}{int} aaT\_num\_cols = aa.\hyperlink{classmtk_1_1DenseMatrix_a53f3afb3b6a8d21854458aaa9663cc74}{num\_rows}();
00615 
00616 \textcolor{preprocessor}{  #if MTK\_VERBOSE\_LEVEL > 12}
00617   std::cout << \textcolor{stringliteral}{"Input matrix BEFORE QR factorization:"} << std::endl;
00618   std::cout << aa << std::endl;
00619 \textcolor{preprocessor}{  #endif}
00620 
00621 \textcolor{preprocessor}{  #ifdef MTK\_PRECISION\_DOUBLE}
00622   dgeqrf\_(&aaT\_num\_rows, &aaT\_num\_cols, aa.\hyperlink{classmtk_1_1DenseMatrix_a0c33b8a9e01d157c61ddbdf807c25d84}{data}(), &aaT\_num\_rows,
00623           tau,
00624           work, &lwork, &info);
00625 \textcolor{preprocessor}{  #else}
00626   fgeqrf\_(&aaT\_num\_rows, &aaT\_num\_cols, aa.\hyperlink{classmtk_1_1DenseMatrix_a0c33b8a9e01d157c61ddbdf807c25d84}{data}(), &aaT\_num\_rows,
00627           tau,
00628           work, &lwork, &info);
00629 \textcolor{preprocessor}{  #endif}
00630 
00631   \textcolor{keywordflow}{if} (info == 0) \{
00632     lwork = (int) work[0];
00633   \} \textcolor{keywordflow}{else} \{
00634     std::cerr << \textcolor{stringliteral}{"Could not get value for lwork on line "} << \_\_LINE\_\_ - 5 <<
00635       std::endl;
00636     std::cerr << \textcolor{stringliteral}{"Exiting..."} << std::endl;
00637   \}
00638 
00639 \textcolor{preprocessor}{  #if MTK\_VERBOSE\_LEVEL > 10}
00640   std::cout << \textcolor{stringliteral}{"lwork = "} << std::endl << std::setw(12) << lwork << std::endl
00641     << std::endl;
00642 \textcolor{preprocessor}{  #endif}
00643 
00644   \textcolor{keyword}{delete} [] work;
00645   work = \textcolor{keyword}{nullptr};
00646 
00647   \textcolor{comment}{// Once we know lwork, we can actually invoke the factorization:}
00648   \textcolor{keywordflow}{try} \{
00649     work = \textcolor{keyword}{new} \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{mtk::Real} [lwork];
00650   \} \textcolor{keywordflow}{catch} (std::bad\_alloc &memory\_allocation\_exception) \{
00651     std::cerr << \textcolor{stringliteral}{"Memory allocation exception on line "} << \_\_LINE\_\_ - 3 <<
00652       std::endl;
00653     std::cerr << memory\_allocation\_exception.what() << std::endl;
00654   \}
00655   memset(work, \hyperlink{group__c01-roots_ga59a451a5fae30d59649bcda274fea271}{mtk::kZero}, \textcolor{keyword}{sizeof}(work[0])*lwork);
00656 
00657   \textcolor{keywordtype}{int} ltau = std::min(aaT\_num\_rows,aaT\_num\_cols);
00658 
00659   \textcolor{keywordflow}{try} \{
00660     tau = \textcolor{keyword}{new} \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{mtk::Real} [ltau];
00661   \} \textcolor{keywordflow}{catch} (std::bad\_alloc &memory\_allocation\_exception) \{
00662     std::cerr << \textcolor{stringliteral}{"Memory allocation exception on line "} << \_\_LINE\_\_ - 3 <<
00663       std::endl;
00664     std::cerr << memory\_allocation\_exception.what() << std::endl;
00665   \}
00666   memset(tau, \hyperlink{group__c01-roots_ga59a451a5fae30d59649bcda274fea271}{mtk::kZero}, \textcolor{keyword}{sizeof}(0.0)*ltau);
00667 
00668 \textcolor{preprocessor}{  #ifdef MTK\_PRECISION\_DOUBLE}
00669   dgeqrf\_(&aaT\_num\_rows, &aaT\_num\_cols, aa.\hyperlink{classmtk_1_1DenseMatrix_a0c33b8a9e01d157c61ddbdf807c25d84}{data}(), &aaT\_num\_rows,
00670           tau, work, &lwork, &info);
00671 \textcolor{preprocessor}{  #else}
00672   fgeqrf\_(&aaT\_num\_rows, &aaT\_num\_cols, aa.\hyperlink{classmtk_1_1DenseMatrix_a0c33b8a9e01d157c61ddbdf807c25d84}{data}(), &aaT\_num\_rows,
00673           tau, work, &lwork, &info);
00674 \textcolor{preprocessor}{  #endif}
00675 
00676 \textcolor{preprocessor}{  #ifdef MTK\_PERFORM\_PREVENTIONS}
00677   \textcolor{keywordflow}{if} (!info) \{
00678     std::cout << \textcolor{stringliteral}{"QR factorization completed!"} << std::endl << std::endl;
00679   \} \textcolor{keywordflow}{else} \{
00680     std::cerr << \textcolor{stringliteral}{"Error solving system! info = "} << info << std::endl;
00681     std::cerr << \textcolor{stringliteral}{"Exiting..."} << std::endl;
00682   \}
00683 \textcolor{preprocessor}{  #endif}
00684 
00685 \textcolor{preprocessor}{  #if MTK\_VERBOSE\_LEVEL > 12}
00686   std::cout << \textcolor{stringliteral}{"Input matrix AFTER QR factorization:"} << std::endl;
00687   std::cout << aa << std::endl;
00688 \textcolor{preprocessor}{  #endif}
00689 
00690   \textcolor{comment}{// We now generate the real matrix Q with orthonormal columns. This has to}
00691   \textcolor{comment}{// be done separately since the actual output of dgeqrf\_ (AA\_) represents}
00692   \textcolor{comment}{// the orthogonal matrix Q as a product of min(aa\_num\_rows, aa\_num\_cols)}
00693   \textcolor{comment}{// elementary Householder reflectors. Notice that we must re-inquire the new}
00694   \textcolor{comment}{// value for lwork that is used.}
00695 
00696   \textcolor{keywordtype}{bool} padded\{\textcolor{keyword}{false}\};
00697 
00698   \textcolor{keywordtype}{bool} transpose\{\textcolor{keyword}{false}\};
00699 
00700   \hyperlink{classmtk_1_1DenseMatrix}{mtk::DenseMatrix} QQ\_(aa.\hyperlink{classmtk_1_1DenseMatrix_a41747502d468c6728a4be31501b16e0e}{num\_cols}(),padded,transpose);
00701 
00702 \textcolor{preprocessor}{  #if MTK\_VERBOSE\_LEVEL > 12}
00703   std::cout << \textcolor{stringliteral}{"Initialized QQ\_T: "} << std::endl;
00704   std::cout << QQ\_ << std::endl;
00705 \textcolor{preprocessor}{  #endif}
00706 
00707   \textcolor{comment}{// Assemble the QQ\_ matrix:}
00708   lwork = -1;
00709 
00710   \textcolor{keyword}{delete}[] work;
00711   work = \textcolor{keyword}{nullptr};
00712 
00713   \textcolor{keywordflow}{try} \{
00714     work = \textcolor{keyword}{new} \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{mtk::Real}[1];
00715   \} \textcolor{keywordflow}{catch} (std::bad\_alloc &memory\_allocation\_exception) \{
00716     std::cerr << \textcolor{stringliteral}{"Memory allocation exception on line "} << \_\_LINE\_\_ - 3 <<
00717       std::endl;
00718     std::cerr << memory\_allocation\_exception.what() <<
00719       std::endl;
00720   \}
00721   memset(work, \hyperlink{group__c01-roots_ga59a451a5fae30d59649bcda274fea271}{mtk::kZero}, \textcolor{keyword}{sizeof}(work[0])*1);
00722 
00723   \textcolor{keywordtype}{char} side\_\{\textcolor{charliteral}{'L'}\};
00724   \textcolor{keywordtype}{char} trans\_\{\textcolor{charliteral}{'N'}\};
00725 
00726   \textcolor{keywordtype}{int} aux = QQ\_.num\_rows();
00727 
00728 \textcolor{preprocessor}{  #ifdef MTK\_PRECISION\_DOUBLE}
00729   dormqr\_(&side\_, &trans\_,
00730           &aa\_num\_cols, &aa\_num\_cols, &ltau, aa.\hyperlink{classmtk_1_1DenseMatrix_a0c33b8a9e01d157c61ddbdf807c25d84}{data}(), &aaT\_num\_rows, tau,
00731           QQ\_.data(), &aux, work, &lwork, &info);
00732 \textcolor{preprocessor}{  #else}
00733   formqr\_(&side\_, &trans\_,
00734           &aa\_num\_cols, &aa\_num\_cols, &ltau, aa.\hyperlink{classmtk_1_1DenseMatrix_a0c33b8a9e01d157c61ddbdf807c25d84}{data}(), &aaT\_num\_rows, tau,
00735           QQ\_.data(), &aux, work, &lwork, &info);
00736 \textcolor{preprocessor}{  #endif}
00737 
00738   \textcolor{keywordflow}{if} (info == 0) \{
00739     lwork = (int) work[0];
00740   \} \textcolor{keywordflow}{else} \{
00741     std::cerr << \textcolor{stringliteral}{"Could not get lwork on line "} << \_\_LINE\_\_ - 5 << std::endl;
00742     std::cerr << \textcolor{stringliteral}{"Exiting..."} << std::endl;
00743   \}
00744 
00745 \textcolor{preprocessor}{  #if MTK\_VERBOSE\_LEVEL > 10}
00746   std::cout << \textcolor{stringliteral}{"lwork = "} << std::endl << std::setw(12) << lwork <<
00747     std::endl << std::endl;
00748 \textcolor{preprocessor}{  #endif}
00749 
00750   \textcolor{keyword}{delete}[] work;
00751   work = \textcolor{keyword}{nullptr};
00752 
00753   \textcolor{keywordflow}{try} \{
00754     work = \textcolor{keyword}{new} \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{mtk::Real}[lwork];
00755   \} \textcolor{keywordflow}{catch} (std::bad\_alloc &memory\_allocation\_exception) \{
00756     std::cerr << \textcolor{stringliteral}{"Memory allocation exception on line "} << \_\_LINE\_\_ - 3 <<
00757       std::endl;
00758     std::cerr << memory\_allocation\_exception.what() << std::endl;
00759   \}
00760   memset(work, \hyperlink{group__c01-roots_ga59a451a5fae30d59649bcda274fea271}{mtk::kZero}, \textcolor{keyword}{sizeof}(work[0])*lwork);
00761 
00762 \textcolor{preprocessor}{  #ifdef MTK\_PRECISION\_DOUBLE}
00763   dormqr\_(&side\_, &trans\_,
00764           &aa\_num\_cols, &aa\_num\_cols, &ltau, aa.\hyperlink{classmtk_1_1DenseMatrix_a0c33b8a9e01d157c61ddbdf807c25d84}{data}(), &aaT\_num\_rows, tau,
00765           QQ\_.data(), &aux, work, &lwork, &info);
00766 \textcolor{preprocessor}{  #else}
00767   formqr\_(&side\_, &trans\_,
00768           &aa\_num\_cols, &aa\_num\_cols, &ltau, aa.\hyperlink{classmtk_1_1DenseMatrix_a0c33b8a9e01d157c61ddbdf807c25d84}{data}(), &aaT\_num\_rows, tau,
00769           QQ\_.data(), &aux, work, &lwork, &info);
00770 \textcolor{preprocessor}{  #endif}
00771 
00772 \textcolor{preprocessor}{  #ifdef MTK\_PERFORM\_PREVENTIONS}
00773   \textcolor{keywordflow}{if} (!info) \{
00774     std::cout << \textcolor{stringliteral}{"Q matrix successfully assembled!"} << std::endl << std::endl;
00775   \} \textcolor{keywordflow}{else} \{
00776     std::cerr << \textcolor{stringliteral}{"Something went wrong solving system! info = "} << info <<
00777       std::endl;
00778     std::cerr << \textcolor{stringliteral}{"Exiting..."} << std::endl;
00779   \}
00780 \textcolor{preprocessor}{  #endif}
00781 
00782   \textcolor{keyword}{delete}[] work;
00783   work = \textcolor{keyword}{nullptr};
00784 
00785   \textcolor{keyword}{delete}[] tau;
00786   tau = \textcolor{keyword}{nullptr};
00787 
00788   \textcolor{keywordflow}{return} QQ\_;
00789 \}
00790 
\hypertarget{mtk__lapack__adapter_8cc_source_l00791}{}\hyperlink{classmtk_1_1LAPACKAdapter_a380f148ffdf96bae2f79ae28f1a6560c}{00791} \textcolor{keywordtype}{int} \hyperlink{classmtk_1_1LAPACKAdapter_a380f148ffdf96bae2f79ae28f1a6560c}{mtk::LAPACKAdapter::SolveRectangularDenseSystem}(\textcolor{keyword}{const} 
      \hyperlink{classmtk_1_1DenseMatrix}{mtk::DenseMatrix} &aa,
00792                                                    \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{mtk::Real} *ob\_,
00793                                                    \textcolor{keywordtype}{int} ob\_ld\_) \{
00794 
00795   \textcolor{comment}{// We first invoke the solver to query for the value of lwork. For this,}
00796   \textcolor{comment}{// we must at least allocate enough space to allow access to WORK(1), or}
00797   \textcolor{comment}{// work[0]:}
00798 
00799   \textcolor{comment}{// If LWORK = -1, then a workspace query is assumed; the routine only}
00800   \textcolor{comment}{// calculates the optimal size of the WORK array, returns this value as}
00801   \textcolor{comment}{// the first entry of the WORK array, and no error message related to}
00802   \textcolor{comment}{// LWORK is issued by XERBLA.}
00803 
00804   \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{mtk::Real} *work\{\}; \textcolor{comment}{// Work array.}
00805 
00806   \textcolor{keywordflow}{try} \{
00807     work = \textcolor{keyword}{new} \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{mtk::Real}[1];
00808   \} \textcolor{keywordflow}{catch} (std::bad\_alloc &memory\_allocation\_exception) \{
00809     std::cerr << \textcolor{stringliteral}{"Memory allocation exception on line "} << \_\_LINE\_\_ - 3 <<
00810       std::endl;
00811     std::cerr << memory\_allocation\_exception.what() << std::endl;
00812   \}
00813   memset(work, \hyperlink{group__c01-roots_ga59a451a5fae30d59649bcda274fea271}{mtk::kZero}, \textcolor{keyword}{sizeof}(work[0])*1);
00814 
00815   \textcolor{keywordtype}{char} trans\_\{\textcolor{charliteral}{'N'}\};
00816   \textcolor{keywordtype}{int} nrhs\_\{1\};
00817   \textcolor{keywordtype}{int} info\{0\};
00818   \textcolor{keywordtype}{int} lwork\{-1\};
00819 
00820   \textcolor{keywordtype}{int} AA\_num\_rows\_  = aa.\hyperlink{classmtk_1_1DenseMatrix_a41747502d468c6728a4be31501b16e0e}{num\_cols}();
00821   \textcolor{keywordtype}{int} AA\_num\_cols\_  = aa.\hyperlink{classmtk_1_1DenseMatrix_a53f3afb3b6a8d21854458aaa9663cc74}{num\_rows}();
00822   \textcolor{keywordtype}{int} AA\_ld\_ = std::max(1,aa.\hyperlink{classmtk_1_1DenseMatrix_a41747502d468c6728a4be31501b16e0e}{num\_cols}());
00823 
00824 \textcolor{preprocessor}{  #ifdef MTK\_PRECISION\_DOUBLE}
00825   dgels\_(&trans\_, &AA\_num\_rows\_, &AA\_num\_cols\_, &nrhs\_, aa.\hyperlink{classmtk_1_1DenseMatrix_a0c33b8a9e01d157c61ddbdf807c25d84}{data}(), &AA\_ld\_,
00826          ob\_, &ob\_ld\_,
00827          work, &lwork, &info);
00828 \textcolor{preprocessor}{  #else}
00829   \hyperlink{namespacemtk_ada6df1b733204aa7ff0b1ec7556288f9}{sgels\_}(&trans\_, &AA\_num\_rows\_, &AA\_num\_cols\_, &nrhs\_, aa.\hyperlink{classmtk_1_1DenseMatrix_a0c33b8a9e01d157c61ddbdf807c25d84}{data}(), &AA\_ld\_,
00830          ob\_, &ob\_ld\_,
00831          work, &lwork, &info);
00832 \textcolor{preprocessor}{  #endif}
00833 
00834   \textcolor{keywordflow}{if} (info == 0) \{
00835     lwork = (int) work[0];
00836   \} \textcolor{keywordflow}{else} \{
00837     std::cerr << \textcolor{stringliteral}{"Could not get value for lwork on line "} << \_\_LINE\_\_ - 2 <<
00838       std::endl;
00839     std::cerr << \textcolor{stringliteral}{"Exiting..."} << std::endl;
00840     \textcolor{keywordflow}{return} info;
00841   \}
00842 
00843 \textcolor{preprocessor}{  #if MTK\_VERBOSE\_LEVEL > 10}
00844   std::cout << \textcolor{stringliteral}{"lwork = "} << std::endl << std::setw(12)<< lwork <<
00845     std::endl << std::endl;
00846 \textcolor{preprocessor}{  #endif}
00847 
00848   \textcolor{comment}{// We then use lwork's new value to create the work array:}
00849   \textcolor{keyword}{delete}[] work;
00850   work = \textcolor{keyword}{nullptr};
00851 
00852   \textcolor{keywordflow}{try} \{
00853     work = \textcolor{keyword}{new} \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{mtk::Real}[lwork];
00854   \} \textcolor{keywordflow}{catch} (std::bad\_alloc &memory\_allocation\_exception) \{
00855     std::cerr << \textcolor{stringliteral}{"Memory allocation exception on line "} << \_\_LINE\_\_ - 3 << std::endl;
00856     std::cerr << memory\_allocation\_exception.what() << std::endl;
00857   \}
00858   memset(work, 0.0, \textcolor{keyword}{sizeof}(work[0])*lwork);
00859 
00860   \textcolor{comment}{// We now invoke the solver again:}
00861 \textcolor{preprocessor}{  #ifdef MTK\_PRECISION\_DOUBLE}
00862   dgels\_(&trans\_, &AA\_num\_rows\_, &AA\_num\_cols\_, &nrhs\_, aa.\hyperlink{classmtk_1_1DenseMatrix_a0c33b8a9e01d157c61ddbdf807c25d84}{data}(), &AA\_ld\_,
00863          ob\_, &ob\_ld\_,
00864          work, &lwork, &info);
00865 \textcolor{preprocessor}{  #else}
00866   \hyperlink{namespacemtk_ada6df1b733204aa7ff0b1ec7556288f9}{sgels\_}(&trans\_, &AA\_num\_rows\_, &AA\_num\_cols\_, &nrhs\_, aa.\hyperlink{classmtk_1_1DenseMatrix_a0c33b8a9e01d157c61ddbdf807c25d84}{data}(), &AA\_ld\_,
00867          ob\_, &ob\_ld\_,
00868          work, &lwork, &info);
00869 \textcolor{preprocessor}{  #endif}
00870 
00871   \textcolor{keyword}{delete} [] work;
00872   work = \textcolor{keyword}{nullptr};
00873 
00874   \textcolor{keywordflow}{return} info;
00875 \}
\end{DoxyCode}
