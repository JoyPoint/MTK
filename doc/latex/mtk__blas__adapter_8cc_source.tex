\hypertarget{mtk__blas__adapter_8cc_source}{\section{mtk\+\_\+blas\+\_\+adapter.\+cc}
\label{mtk__blas__adapter_8cc_source}\index{src/mtk\+\_\+blas\+\_\+adapter.\+cc@{src/mtk\+\_\+blas\+\_\+adapter.\+cc}}
}

\begin{DoxyCode}
00001 
00027 \textcolor{comment}{/*}
00028 \textcolor{comment}{Copyright (C) 2015, Computational Science Research Center, San Diego State}
00029 \textcolor{comment}{University. All rights reserved.}
00030 \textcolor{comment}{}
00031 \textcolor{comment}{Redistribution and use in source and binary forms, with or without modification,}
00032 \textcolor{comment}{are permitted provided that the following conditions are met:}
00033 \textcolor{comment}{}
00034 \textcolor{comment}{1. Modifications to source code should be reported to: esanchez@mail.sdsu.edu}
00035 \textcolor{comment}{and a copy of the modified files should be reported once modifications are}
00036 \textcolor{comment}{completed, unless these modifications are made through the project's GitHub}
00037 \textcolor{comment}{page: http://www.csrc.sdsu.edu/mtk. Documentation related to said modifications}
00038 \textcolor{comment}{should be developed and included in any deliverable.}
00039 \textcolor{comment}{}
00040 \textcolor{comment}{2. Redistributions of source code must be done through direct}
00041 \textcolor{comment}{downloads from the project's GitHub page: http://www.csrc.sdsu.edu/mtk}
00042 \textcolor{comment}{}
00043 \textcolor{comment}{3. Redistributions in binary form must reproduce the above copyright notice,}
00044 \textcolor{comment}{this list of conditions and the following disclaimer in the documentation and/or}
00045 \textcolor{comment}{other materials provided with the distribution.}
00046 \textcolor{comment}{}
00047 \textcolor{comment}{4. Usage of the binary form on proprietary applications shall require explicit}
00048 \textcolor{comment}{prior written permission from the the copyright holders, and due credit should}
00049 \textcolor{comment}{be given to the copyright holders.}
00050 \textcolor{comment}{}
00051 \textcolor{comment}{5. Neither the name of the copyright holder nor the names of its contributors}
00052 \textcolor{comment}{may be used to endorse or promote products derived from this software without}
00053 \textcolor{comment}{specific prior written permission.}
00054 \textcolor{comment}{}
00055 \textcolor{comment}{The copyright holders provide no reassurances that the source code provided does}
00056 \textcolor{comment}{not infringe any patent, copyright, or any other intellectual property rights of}
00057 \textcolor{comment}{third parties. The copyright holders disclaim any liability to any recipient for}
00058 \textcolor{comment}{claims brought against recipient by any third party for infringement of that}
00059 \textcolor{comment}{parties intellectual property rights.}
00060 \textcolor{comment}{}
00061 \textcolor{comment}{THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND}
00062 \textcolor{comment}{ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED}
00063 \textcolor{comment}{WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE}
00064 \textcolor{comment}{DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR}
00065 \textcolor{comment}{ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES}
00066 \textcolor{comment}{(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;}
00067 \textcolor{comment}{LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON}
00068 \textcolor{comment}{ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT}
00069 \textcolor{comment}{(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS}
00070 \textcolor{comment}{SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.}
00071 \textcolor{comment}{*/}
00072 
00073 \textcolor{preprocessor}{#include <iostream>}
00074 \textcolor{preprocessor}{#include <iomanip>}
00075 
00076 \textcolor{preprocessor}{#include <vector>}
00077 
00078 \textcolor{preprocessor}{#include "\hyperlink{mtk__roots_8h}{mtk\_roots.h}"}
00079 \textcolor{preprocessor}{#include "\hyperlink{mtk__tools_8h}{mtk\_tools.h}"}
00080 \textcolor{preprocessor}{#include "\hyperlink{mtk__blas__adapter_8h}{mtk\_blas\_adapter.h}"}
00081 
00082 \textcolor{keyword}{namespace }\hyperlink{namespacemtk}{mtk} \{
00083 
00084 \textcolor{keyword}{extern} \textcolor{stringliteral}{"C"} \{
00085 
00086 \textcolor{preprocessor}{#ifdef MTK\_PRECISION\_DOUBLE}
00087 
00100 \textcolor{keywordtype}{double} dnrm2\_(\textcolor{keywordtype}{int} *n, \textcolor{keywordtype}{double} *x, \textcolor{keywordtype}{int} *incx);
00101 \textcolor{preprocessor}{#else}
00102 
00115 \textcolor{keywordtype}{float} \hyperlink{namespacemtk_a508e99fcb14d526bc43aa0a80aa4b658}{snrm2\_}(\textcolor{keywordtype}{int} *n, \textcolor{keywordtype}{float} *x, \textcolor{keywordtype}{int} *incx);
00116 \textcolor{preprocessor}{#endif}
00117 
00118 \textcolor{preprocessor}{#ifdef MTK\_PRECISION\_DOUBLE}
00119 
00138 \textcolor{keywordtype}{void} daxpy\_(\textcolor{keywordtype}{int} *n, \textcolor{keywordtype}{double} *da, \textcolor{keywordtype}{double} *dx, \textcolor{keywordtype}{int} *incx, \textcolor{keywordtype}{double} *dy, \textcolor{keywordtype}{int} *incy);
00139 \textcolor{preprocessor}{#else}
00140 
00159 \textcolor{keywordtype}{void} \hyperlink{namespacemtk_a81a2d7d1ea9eff65ae13646c93dad5e9}{saxpy\_}(\textcolor{keywordtype}{int} *n, \textcolor{keywordtype}{float} *sa, \textcolor{keywordtype}{float} *sx, \textcolor{keywordtype}{int} *incx, \textcolor{keywordtype}{float} *sy, \textcolor{keywordtype}{int} *incy);
00160 \textcolor{preprocessor}{#endif}
00161 
00162 \textcolor{preprocessor}{#ifdef MTK\_PRECISION\_DOUBLE}
00163 
00191 \textcolor{keywordtype}{void} dgemv\_(\textcolor{keywordtype}{char} *trans,
00192             \textcolor{keywordtype}{int} *m,
00193             \textcolor{keywordtype}{int} *n,
00194             \textcolor{keywordtype}{double} *alpha,
00195             \textcolor{keywordtype}{double} *a,
00196             \textcolor{keywordtype}{int} *lda,
00197             \textcolor{keywordtype}{double} *x,
00198             \textcolor{keywordtype}{int} *incx,
00199             \textcolor{keywordtype}{double} *beta,
00200             \textcolor{keywordtype}{double} *y,
00201             \textcolor{keywordtype}{int} *incy);
00202 \textcolor{preprocessor}{#else}
00203 
00231 \textcolor{keywordtype}{void} \hyperlink{namespacemtk_a88daff7ad6f251a58b94aa2d0c94d069}{sgemv\_}(\textcolor{keywordtype}{char} *trans,
00232             \textcolor{keywordtype}{int} *m,
00233             \textcolor{keywordtype}{int} *n,
00234             \textcolor{keywordtype}{float} *alpha,
00235             \textcolor{keywordtype}{float} *a,
00236             \textcolor{keywordtype}{int} *lda,
00237             \textcolor{keywordtype}{float} *x,
00238             \textcolor{keywordtype}{int} *incx,
00239             \textcolor{keywordtype}{float} *beta,
00240             \textcolor{keywordtype}{float} *y,
00241             \textcolor{keywordtype}{int} *incy);
00242 \textcolor{preprocessor}{#endif}
00243 
00244 \textcolor{preprocessor}{#ifdef MTK\_PRECISION\_DOUBLE}
00245 
00270 \textcolor{keywordtype}{void} dgemm\_(\textcolor{keywordtype}{char} *transa,
00271             \textcolor{keywordtype}{char}* transb,
00272             \textcolor{keywordtype}{int} *m,
00273             \textcolor{keywordtype}{int} *n,
00274             \textcolor{keywordtype}{int} *k,
00275             \textcolor{keywordtype}{double} *alpha,
00276             \textcolor{keywordtype}{double} *a,
00277             \textcolor{keywordtype}{int} *lda,
00278             \textcolor{keywordtype}{double} *b,
00279             \textcolor{keywordtype}{int} *ldb,
00280             \textcolor{keywordtype}{double} *beta,
00281             \textcolor{keywordtype}{double} *c,
00282             \textcolor{keywordtype}{int} *ldc);
00283 \}
00284 \textcolor{preprocessor}{#else}
00285 
00310 \textcolor{keywordtype}{void} \hyperlink{namespacemtk_adb7c0560326b8e57f255e58b87ec76b0}{sgemm\_}(\textcolor{keywordtype}{char} *transa,
00311             \textcolor{keywordtype}{char}* transb,
00312             \textcolor{keywordtype}{int} *m,
00313             \textcolor{keywordtype}{int} *n,
00314             \textcolor{keywordtype}{int} *k,
00315             \textcolor{keywordtype}{double} *alpha,
00316             \textcolor{keywordtype}{double} *a,
00317             \textcolor{keywordtype}{int} *lda,
00318             \textcolor{keywordtype}{double} *b,aamm
00319             \textcolor{keywordtype}{int} *ldb,
00320             \textcolor{keywordtype}{double} *beta,
00321             \textcolor{keywordtype}{double} *c,
00322             \textcolor{keywordtype}{int} *ldc);
00323 \}
00324 \textcolor{preprocessor}{#endif}
00325 \}
00326 
\hypertarget{mtk__blas__adapter_8cc_source_l00327}{}\hyperlink{classmtk_1_1BLASAdapter_ab92440888b730863244c5d9479c11aca}{00327} \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{mtk::Real} \hyperlink{classmtk_1_1BLASAdapter_ab92440888b730863244c5d9479c11aca}{mtk::BLASAdapter::RealNRM2}(\hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{Real} *in, \textcolor{keywordtype}{int} &in\_length) \{
00328 
00329 \textcolor{preprocessor}{  #ifdef MTK\_PERFORM\_PREVENTIONS}
00330   \hyperlink{classmtk_1_1Tools_a332324c6f25e66be9dff48c5987a3b9f}{mtk::Tools::Prevent}(in\_length <= 0, \_\_FILE\_\_, \_\_LINE\_\_, \_\_func\_\_);
00331 \textcolor{preprocessor}{  #endif}
00332 
00333   \textcolor{keywordtype}{int} incx\{1\};  \textcolor{comment}{// Increment for the elements of xx. ix >= 0.}
00334 
00335 \textcolor{preprocessor}{  #ifdef MTK\_PRECISION\_DOUBLE}
00336   \textcolor{keywordflow}{return} dnrm2\_(&in\_length, in, &incx);
00337 \textcolor{preprocessor}{  #else}
00338   \textcolor{keywordflow}{return} \hyperlink{namespacemtk_a508e99fcb14d526bc43aa0a80aa4b658}{snrm2\_}(&in\_length, in, &incx);
00339 \textcolor{preprocessor}{  #endif}
00340 \}
00341 
\hypertarget{mtk__blas__adapter_8cc_source_l00342}{}\hyperlink{classmtk_1_1BLASAdapter_a081cd092ae65e730f44eae8643edd539}{00342} \textcolor{keywordtype}{void} \hyperlink{classmtk_1_1BLASAdapter_a081cd092ae65e730f44eae8643edd539}{mtk::BLASAdapter::RealAXPY}(\hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{mtk::Real} alpha,
00343                                      \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{mtk::Real} *xx,
00344                                      \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{mtk::Real} *yy,
00345                                      \textcolor{keywordtype}{int} &in\_length) \{
00346 
00347 \textcolor{preprocessor}{  #ifdef MTK\_PERFORM\_PREVENTIONS}
00348   \hyperlink{classmtk_1_1Tools_a332324c6f25e66be9dff48c5987a3b9f}{mtk::Tools::Prevent}(xx == \textcolor{keyword}{nullptr}, \_\_FILE\_\_, \_\_LINE\_\_, \_\_func\_\_);
00349   \hyperlink{classmtk_1_1Tools_a332324c6f25e66be9dff48c5987a3b9f}{mtk::Tools::Prevent}(yy == \textcolor{keyword}{nullptr}, \_\_FILE\_\_, \_\_LINE\_\_, \_\_func\_\_);
00350 \textcolor{preprocessor}{  #endif}
00351 
00352   \textcolor{keywordtype}{int} incx\{1\};  \textcolor{comment}{// Increment for the elements of xx. ix >= 0.}
00353 
00354 \textcolor{preprocessor}{  #ifdef MTK\_PRECISION\_DOUBLE}
00355   daxpy\_(&in\_length, &alpha, xx, &incx, yy, &incx);
00356 \textcolor{preprocessor}{  #else}
00357   \hyperlink{namespacemtk_a81a2d7d1ea9eff65ae13646c93dad5e9}{saxpy\_}(&in\_length, &alpha, xx, &incx, yy, &incx);
00358 \textcolor{preprocessor}{  #endif}
00359 \}
00360 
\hypertarget{mtk__blas__adapter_8cc_source_l00361}{}\hyperlink{classmtk_1_1BLASAdapter_af2ac5691f45e67d6e26186b071119ec4}{00361} \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{mtk::Real} \hyperlink{classmtk_1_1BLASAdapter_af2ac5691f45e67d6e26186b071119ec4}{mtk::BLASAdapter::RelNorm2Error}(
      \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{mtk::Real} *computed,
00362                                           \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{mtk::Real} *known,
00363                                           \textcolor{keywordtype}{int} length) \{
00364 
00365 \textcolor{preprocessor}{  #ifdef MTK\_PERFORM\_PREVENTIONS}
00366   \hyperlink{classmtk_1_1Tools_a332324c6f25e66be9dff48c5987a3b9f}{mtk::Tools::Prevent}(computed == \textcolor{keyword}{nullptr}, \_\_FILE\_\_, \_\_LINE\_\_, \_\_func\_\_);
00367   \hyperlink{classmtk_1_1Tools_a332324c6f25e66be9dff48c5987a3b9f}{mtk::Tools::Prevent}(known == \textcolor{keyword}{nullptr}, \_\_FILE\_\_, \_\_LINE\_\_, \_\_func\_\_);
00368 \textcolor{preprocessor}{  #endif}
00369 
00370   \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{mtk::Real} norm\_2\_computed\{\hyperlink{classmtk_1_1BLASAdapter_ab92440888b730863244c5d9479c11aca}{mtk::BLASAdapter::RealNRM2}(known, length)\};
00371 
00372   \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{mtk::Real} alpha\{-\hyperlink{group__c01-roots_ga26407c24d43b6b95480943340d285c71}{mtk::kOne}\};
00373 
00374   \hyperlink{classmtk_1_1BLASAdapter_a081cd092ae65e730f44eae8643edd539}{mtk::BLASAdapter::RealAXPY}(alpha, known, computed, length);
00375 
00376   \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{mtk::Real} norm\_2\_difference\{\hyperlink{classmtk_1_1BLASAdapter_ab92440888b730863244c5d9479c11aca}{mtk::BLASAdapter::RealNRM2}(computed, 
      length)\};
00377 
00378   \textcolor{keywordflow}{return} norm\_2\_difference/norm\_2\_computed;
00379 \}
00380 
\hypertarget{mtk__blas__adapter_8cc_source_l00381}{}\hyperlink{classmtk_1_1BLASAdapter_afdcac059a4294287cb55638221220646}{00381} \textcolor{keywordtype}{void} \hyperlink{classmtk_1_1BLASAdapter_afdcac059a4294287cb55638221220646}{mtk::BLASAdapter::RealDenseMV}(\hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{mtk::Real} &alpha,
00382                                    \hyperlink{classmtk_1_1DenseMatrix}{mtk::DenseMatrix} &aa,
00383                                    \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{mtk::Real} *xx,
00384                                    \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{mtk::Real} &beta,
00385                                    \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{mtk::Real} *yy) \{
00386 
00387   \textcolor{comment}{// Make sure input matrices are row-major ordered.}
00388 
00389   \textcolor{keywordflow}{if} (aa.\hyperlink{classmtk_1_1DenseMatrix_a5aa83a0643f27a4652ea97630edf7143}{matrix\_properties}().\hyperlink{classmtk_1_1Matrix_a13cd17621652cd5551ff98549bd94df7}{ordering}() == 
      \hyperlink{namespacemtk_ga622801bd9f912d0f976c3e383f5f581ca34d2765ffc490951febdcca04bc4f7cd}{mtk::MatrixOrdering::COL\_MAJOR}) \{
00390     aa.\hyperlink{classmtk_1_1DenseMatrix_ac2949efba3e8278335d45418c85433e4}{OrderRowMajor}();
00391   \}
00392 
00393   \textcolor{keywordtype}{char} transa\{\textcolor{charliteral}{'T'}\}; \textcolor{comment}{// State that now, the input WILL be in row-major ordering.}
00394 
00395   \textcolor{keywordtype}{int} mm\{aa.\hyperlink{classmtk_1_1DenseMatrix_a53f3afb3b6a8d21854458aaa9663cc74}{num\_rows}()\};                  \textcolor{comment}{// Rows of aa.}
00396   \textcolor{keywordtype}{int} nn\{aa.\hyperlink{classmtk_1_1DenseMatrix_a41747502d468c6728a4be31501b16e0e}{num\_cols}()\};                  \textcolor{comment}{// Columns of aa.}
00397   \textcolor{keywordtype}{int} lda\{(aa.\hyperlink{classmtk_1_1DenseMatrix_a5aa83a0643f27a4652ea97630edf7143}{matrix\_properties}()).ld()\}; \textcolor{comment}{// Leading dimension.}
00398   \textcolor{keywordtype}{int} incx\{1\};                            \textcolor{comment}{// Increment of values in x.}
00399   \textcolor{keywordtype}{int} incy\{1\};                            \textcolor{comment}{// Increment of values in y.}
00400 
00401   std::swap(mm,nn);
00402 \textcolor{preprocessor}{  #ifdef MTK\_PRECISION\_DOUBLE}
00403   dgemv\_(&transa, &mm, &nn, &alpha, aa.\hyperlink{classmtk_1_1DenseMatrix_a0c33b8a9e01d157c61ddbdf807c25d84}{data}(), &lda,
00404          xx, &incx, &beta, yy, &incy);
00405 \textcolor{preprocessor}{  #else}
00406   \hyperlink{namespacemtk_a88daff7ad6f251a58b94aa2d0c94d069}{sgemv\_}(&transa, &mm, &nn, &alpha, aa.\hyperlink{classmtk_1_1DenseMatrix_a0c33b8a9e01d157c61ddbdf807c25d84}{data}(), &lda,
00407         xx, &incx, &beta, yy, &incy);
00408 \textcolor{preprocessor}{  #endif}
00409   std::swap(mm,nn);
00410 \}
00411 
\hypertarget{mtk__blas__adapter_8cc_source_l00412}{}\hyperlink{classmtk_1_1BLASAdapter_acebd0e9bfe0bdd609c7fbea98ccfd3b5}{00412} \hyperlink{classmtk_1_1DenseMatrix}{mtk::DenseMatrix} \hyperlink{classmtk_1_1BLASAdapter_acebd0e9bfe0bdd609c7fbea98ccfd3b5}{mtk::BLASAdapter::RealDenseMM}(
      \hyperlink{classmtk_1_1DenseMatrix}{mtk::DenseMatrix} &aa,
00413                                                \hyperlink{classmtk_1_1DenseMatrix}{mtk::DenseMatrix} &bb) \{
00414 
00415 \textcolor{preprocessor}{  #ifdef MTK\_PERFORM\_PREVENTIONS}
00416   \hyperlink{classmtk_1_1Tools_a332324c6f25e66be9dff48c5987a3b9f}{mtk::Tools::Prevent}(aa.\hyperlink{classmtk_1_1DenseMatrix_a41747502d468c6728a4be31501b16e0e}{num\_cols}() != bb.\hyperlink{classmtk_1_1DenseMatrix_a53f3afb3b6a8d21854458aaa9663cc74}{num\_rows}(),
00417                       \_\_FILE\_\_, \_\_LINE\_\_, \_\_func\_\_);
00418 \textcolor{preprocessor}{  #endif}
00419 
00421   \textcolor{keywordflow}{if} (aa.\hyperlink{classmtk_1_1DenseMatrix_a5aa83a0643f27a4652ea97630edf7143}{matrix\_properties}().\hyperlink{classmtk_1_1Matrix_a13cd17621652cd5551ff98549bd94df7}{ordering}() == 
      \hyperlink{namespacemtk_ga622801bd9f912d0f976c3e383f5f581ca34d2765ffc490951febdcca04bc4f7cd}{mtk::MatrixOrdering::COL\_MAJOR}) \{
00422     aa.\hyperlink{classmtk_1_1DenseMatrix_ac2949efba3e8278335d45418c85433e4}{OrderRowMajor}();
00423   \}
00424   \textcolor{keywordflow}{if} (bb.\hyperlink{classmtk_1_1DenseMatrix_a5aa83a0643f27a4652ea97630edf7143}{matrix\_properties}().\hyperlink{classmtk_1_1Matrix_a13cd17621652cd5551ff98549bd94df7}{ordering}() == 
      \hyperlink{namespacemtk_ga622801bd9f912d0f976c3e383f5f581ca34d2765ffc490951febdcca04bc4f7cd}{mtk::MatrixOrdering::COL\_MAJOR}) \{
00425     bb.\hyperlink{classmtk_1_1DenseMatrix_ac2949efba3e8278335d45418c85433e4}{OrderRowMajor}();
00426   \}
00427 
00429   \textcolor{keywordtype}{char} ta\{\textcolor{charliteral}{'T'}\}; \textcolor{comment}{// State that input matrix aa is in row-wise ordering.}
00430   \textcolor{keywordtype}{char} tb\{\textcolor{charliteral}{'T'}\}; \textcolor{comment}{// State that input matrix bb is in row-wise ordering.}
00431 
00432   \textcolor{keywordtype}{int} mm\{aa.\hyperlink{classmtk_1_1DenseMatrix_a53f3afb3b6a8d21854458aaa9663cc74}{num\_rows}()\};  \textcolor{comment}{// Rows of aa and rows of cc.}
00433   \textcolor{keywordtype}{int} nn\{bb.\hyperlink{classmtk_1_1DenseMatrix_a41747502d468c6728a4be31501b16e0e}{num\_cols}()\};  \textcolor{comment}{// Cols of bb and cols of cc.}
00434   \textcolor{keywordtype}{int} kk\{aa.\hyperlink{classmtk_1_1DenseMatrix_a41747502d468c6728a4be31501b16e0e}{num\_cols}()\};  \textcolor{comment}{// Cols of aa and rows of bb.}
00435 
00436   \textcolor{keywordtype}{int} cc\_num\_rows\{mm\};  \textcolor{comment}{// Rows of cc.}
00437   \textcolor{keywordtype}{int} cc\_num\_cols\{nn\};  \textcolor{comment}{// Columns of cc.}
00438 
00439   \textcolor{keywordtype}{int} lda\{std::max(1,kk)\};  \textcolor{comment}{// Leading dimension of the aa matrix.}
00440   \textcolor{keywordtype}{int} ldb\{std::max(1,nn)\};  \textcolor{comment}{// Leading dimension of the bb matrix.}
00441   \textcolor{keywordtype}{int} ldc\{std::max(1,mm)\};  \textcolor{comment}{// Leading dimension of the cc matrix.}
00442 
00443   \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{mtk::Real} alpha\{\hyperlink{group__c01-roots_ga26407c24d43b6b95480943340d285c71}{mtk::kOne}\}; \textcolor{comment}{// First scalar coefficient.}
00444   \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{mtk::Real} beta\{\hyperlink{group__c01-roots_ga59a451a5fae30d59649bcda274fea271}{mtk::kZero}\}; \textcolor{comment}{// Second scalar coefficient.}
00445 
00446   \hyperlink{classmtk_1_1DenseMatrix}{mtk::DenseMatrix} cc\_col\_maj\_ord(cc\_num\_rows,cc\_num\_cols); \textcolor{comment}{// Output matrix.}
00447 
00448   cc\_col\_maj\_ord.\hyperlink{classmtk_1_1DenseMatrix_a178e63f365cf8c547dc5020c60357f5e}{SetOrdering}(\hyperlink{namespacemtk_ga622801bd9f912d0f976c3e383f5f581ca34d2765ffc490951febdcca04bc4f7cd}{mtk::MatrixOrdering::COL\_MAJOR});
00449 
00451 \textcolor{preprocessor}{  #ifdef MTK\_PRECISION\_DOUBLE}
00452   dgemm\_(&ta, &tb, &mm, &nn, &kk, &alpha, aa.\hyperlink{classmtk_1_1DenseMatrix_a0c33b8a9e01d157c61ddbdf807c25d84}{data}(), &lda,
00453          bb.\hyperlink{classmtk_1_1DenseMatrix_a0c33b8a9e01d157c61ddbdf807c25d84}{data}(), &ldb, &beta, cc\_col\_maj\_ord.\hyperlink{classmtk_1_1DenseMatrix_a0c33b8a9e01d157c61ddbdf807c25d84}{data}(), &ldc);
00454 \textcolor{preprocessor}{  #else}
00455   \hyperlink{namespacemtk_adb7c0560326b8e57f255e58b87ec76b0}{sgemm\_}(&ta, &tb, &mm, &nn, &kk, &alpha, aa.\hyperlink{classmtk_1_1DenseMatrix_a0c33b8a9e01d157c61ddbdf807c25d84}{data}(), &lda,
00456          bb.\hyperlink{classmtk_1_1DenseMatrix_a0c33b8a9e01d157c61ddbdf807c25d84}{data}(), &ldb, &beta, cc\_col\_maj\_ord.\hyperlink{classmtk_1_1DenseMatrix_a0c33b8a9e01d157c61ddbdf807c25d84}{data}(), &ldc);
00457 \textcolor{preprocessor}{  #endif}
00458 
00459 \textcolor{preprocessor}{  #if MTK\_VERBOSE\_LEVEL > 12}
00460   std::cout << \textcolor{stringliteral}{"cc\_col\_maj\_ord ="} << std::endl;
00461   std::cout << cc\_col\_maj\_ord << std::endl;
00462 \textcolor{preprocessor}{  #endif}
00463 
00464   cc\_col\_maj\_ord.\hyperlink{classmtk_1_1DenseMatrix_ac2949efba3e8278335d45418c85433e4}{OrderRowMajor}();
00465 
00466   \textcolor{keywordflow}{return} cc\_col\_maj\_ord;
00467 \}
00468 
\hypertarget{mtk__blas__adapter_8cc_source_l00469}{}\hyperlink{classmtk_1_1BLASAdapter_a0dd80d043615a95f11b7341ce69b44d3}{00469} \hyperlink{classmtk_1_1DenseMatrix}{mtk::DenseMatrix} \hyperlink{classmtk_1_1BLASAdapter_a0dd80d043615a95f11b7341ce69b44d3}{mtk::BLASAdapter::RealDenseSM}(
      \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{mtk::Real} alpha,
00470                                                \hyperlink{classmtk_1_1DenseMatrix}{mtk::DenseMatrix} &aa) \{
00471 
00472 \textcolor{preprocessor}{  #ifdef MTK\_PERFORM\_PREVENTIONS}
00473   \hyperlink{classmtk_1_1Tools_a332324c6f25e66be9dff48c5987a3b9f}{mtk::Tools::Prevent}(aa.\hyperlink{classmtk_1_1DenseMatrix_a53f3afb3b6a8d21854458aaa9663cc74}{num\_rows}() == 0, \_\_FILE\_\_, \_\_LINE\_\_, \_\_func\_\_);
00474   \hyperlink{classmtk_1_1Tools_a332324c6f25e66be9dff48c5987a3b9f}{mtk::Tools::Prevent}(aa.\hyperlink{classmtk_1_1DenseMatrix_a41747502d468c6728a4be31501b16e0e}{num\_cols}() == 0, \_\_FILE\_\_, \_\_LINE\_\_, \_\_func\_\_);
00475 \textcolor{preprocessor}{  #endif}
00476 
00478   \textcolor{keywordflow}{if} (aa.\hyperlink{classmtk_1_1DenseMatrix_a5aa83a0643f27a4652ea97630edf7143}{matrix\_properties}().\hyperlink{classmtk_1_1Matrix_a13cd17621652cd5551ff98549bd94df7}{ordering}() == 
      \hyperlink{namespacemtk_ga622801bd9f912d0f976c3e383f5f581ca34d2765ffc490951febdcca04bc4f7cd}{mtk::MatrixOrdering::COL\_MAJOR}) \{
00479     aa.\hyperlink{classmtk_1_1DenseMatrix_ac2949efba3e8278335d45418c85433e4}{OrderRowMajor}();
00480   \}
00481 
00483   \textcolor{keywordtype}{char} ta\{\textcolor{charliteral}{'T'}\}; \textcolor{comment}{// State that input matrix aa is in row-wise ordering.}
00484   \textcolor{keywordtype}{char} tb\{\textcolor{charliteral}{'T'}\}; \textcolor{comment}{// State that input matrix bb is in row-wise ordering.}
00485 
00486   \textcolor{keywordtype}{int} mm\{aa.\hyperlink{classmtk_1_1DenseMatrix_a53f3afb3b6a8d21854458aaa9663cc74}{num\_rows}()\};  \textcolor{comment}{// Rows of aa and rows of cc.}
00487   \textcolor{keywordtype}{int} nn\{aa.\hyperlink{classmtk_1_1DenseMatrix_a41747502d468c6728a4be31501b16e0e}{num\_cols}()\};  \textcolor{comment}{// Cols of bb and cols of cc.}
00488   \textcolor{keywordtype}{int} kk\{aa.\hyperlink{classmtk_1_1DenseMatrix_a41747502d468c6728a4be31501b16e0e}{num\_cols}()\};  \textcolor{comment}{// Cols of aa and rows of bb.}
00489 
00490   \textcolor{keywordtype}{int} lda\{std::max(1,kk)\};  \textcolor{comment}{// Leading dimension of the aa matrix.}
00491   \textcolor{keywordtype}{int} ldb\{std::max(1,nn)\};  \textcolor{comment}{// Leading dimension of the bb matrix.}
00492   \textcolor{keywordtype}{int} ldc\{std::max(1,mm)\};  \textcolor{comment}{// Leading dimension of the cc matrix.}
00493 
00494   \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{mtk::Real} beta\{alpha\}; \textcolor{comment}{// Second scalar coefficient.}
00495 
00496   alpha = \hyperlink{group__c01-roots_ga59a451a5fae30d59649bcda274fea271}{mtk::kZero};
00497 
00498   \hyperlink{classmtk_1_1DenseMatrix}{mtk::DenseMatrix} alpha\_aa(aa); \textcolor{comment}{// Output matrix.}
00499 
00501 \textcolor{preprocessor}{  #ifdef MTK\_PRECISION\_DOUBLE}
00502   dgemm\_(&ta, &tb, &mm, &nn, &kk, &alpha, aa.\hyperlink{classmtk_1_1DenseMatrix_a0c33b8a9e01d157c61ddbdf807c25d84}{data}(), &lda,
00503          aa.\hyperlink{classmtk_1_1DenseMatrix_a0c33b8a9e01d157c61ddbdf807c25d84}{data}(), &ldb, &beta, alpha\_aa.\hyperlink{classmtk_1_1DenseMatrix_a0c33b8a9e01d157c61ddbdf807c25d84}{data}(), &ldc);
00504 \textcolor{preprocessor}{  #else}
00505   \hyperlink{namespacemtk_adb7c0560326b8e57f255e58b87ec76b0}{sgemm\_}(&ta, &tb, &mm, &nn, &kk, &alpha, aa.\hyperlink{classmtk_1_1DenseMatrix_a0c33b8a9e01d157c61ddbdf807c25d84}{data}(), &lda,
00506          aa.\hyperlink{classmtk_1_1DenseMatrix_a0c33b8a9e01d157c61ddbdf807c25d84}{data}(), &ldb, &beta, alpha\_aa.\hyperlink{classmtk_1_1DenseMatrix_a0c33b8a9e01d157c61ddbdf807c25d84}{data}(), &ldc);
00507 \textcolor{preprocessor}{  #endif}
00508 
00509 \textcolor{preprocessor}{  #if MTK\_VERBOSE\_LEVEL > 12}
00510   std::cout << \textcolor{stringliteral}{"alpha\_aa ="} << std::endl;
00511   std::cout << alpha\_aa << std::endl;
00512 \textcolor{preprocessor}{  #endif}
00513 
00514   \textcolor{keywordflow}{return} alpha\_aa;
00515 \}
\end{DoxyCode}
