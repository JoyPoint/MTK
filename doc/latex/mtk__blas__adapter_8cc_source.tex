\hypertarget{mtk__blas__adapter_8cc}{\section{mtk\-\_\-blas\-\_\-adapter.\-cc}
\label{mtk__blas__adapter_8cc}\index{src/mtk\-\_\-blas\-\_\-adapter.\-cc@{src/mtk\-\_\-blas\-\_\-adapter.\-cc}}
}

\begin{DoxyCode}
00001 
00024 \textcolor{comment}{/*}
00025 \textcolor{comment}{Copyright (C) 2015, Computational Science Research Center, San Diego State}
00026 \textcolor{comment}{University. All rights reserved.}
00027 \textcolor{comment}{}
00028 \textcolor{comment}{Redistribution and use in source and binary forms, with or without modification,}
00029 \textcolor{comment}{are permitted provided that the following conditions are met:}
00030 \textcolor{comment}{}
00031 \textcolor{comment}{1. Modifications to source code should be reported to: esanchez@mail.sdsu.edu}
00032 \textcolor{comment}{and a copy of the modified files should be reported once modifications are}
00033 \textcolor{comment}{completed. Documentation related to said modifications should be included.}
00034 \textcolor{comment}{}
00035 \textcolor{comment}{2. Redistributions of source code must be done through direct}
00036 \textcolor{comment}{downloads from the project's GitHub page: http://www.csrc.sdsu.edu/mtk}
00037 \textcolor{comment}{}
00038 \textcolor{comment}{3. Redistributions of source code must retain the above copyright notice, this}
00039 \textcolor{comment}{list of conditions and the following disclaimer.}
00040 \textcolor{comment}{}
00041 \textcolor{comment}{4. Redistributions in binary form must reproduce the above copyright notice,}
00042 \textcolor{comment}{this list of conditions and the following disclaimer in the documentation and/or}
00043 \textcolor{comment}{other materials provided with the distribution.}
00044 \textcolor{comment}{}
00045 \textcolor{comment}{5. Usage of the binary form on proprietary applications shall require explicit}
00046 \textcolor{comment}{prior written permission from the the copyright holders.}
00047 \textcolor{comment}{}
00048 \textcolor{comment}{6. Neither the name of the copyright holder nor the names of its contributors}
00049 \textcolor{comment}{may be used to endorse or promote products derived from this software without}
00050 \textcolor{comment}{specific prior written permission.}
00051 \textcolor{comment}{}
00052 \textcolor{comment}{The copyright holders provide no reassurances that the source code provided does}
00053 \textcolor{comment}{not infringe any patent, copyright, or any other intellectual property rights of}
00054 \textcolor{comment}{third parties. The copyright holders disclaim any liability to any recipient for}
00055 \textcolor{comment}{claims brought against recipient by any third party for infringement of that}
00056 \textcolor{comment}{parties intellectual property rights.}
00057 \textcolor{comment}{}
00058 \textcolor{comment}{THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND}
00059 \textcolor{comment}{ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED}
00060 \textcolor{comment}{WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE}
00061 \textcolor{comment}{DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR}
00062 \textcolor{comment}{ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES}
00063 \textcolor{comment}{(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;}
00064 \textcolor{comment}{LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON}
00065 \textcolor{comment}{ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT}
00066 \textcolor{comment}{(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS}
00067 \textcolor{comment}{SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.}
00068 \textcolor{comment}{*/}
00069 
00070 \textcolor{preprocessor}{#include <iostream>}
00071 \textcolor{preprocessor}{#include <iomanip>}
00072 
00073 \textcolor{preprocessor}{#include <vector>}
00074 
00075 \textcolor{preprocessor}{#include "\hyperlink{mtk__roots_8h}{mtk\_roots.h}"}
00076 \textcolor{preprocessor}{#include "\hyperlink{mtk__tools_8h}{mtk\_tools.h}"}
00077 \textcolor{preprocessor}{#include "\hyperlink{mtk__blas__adapter_8h}{mtk\_blas\_adapter.h}"}
00078 
00079 \textcolor{keyword}{namespace }mtk \{
00080 
00081 \textcolor{keyword}{extern} \textcolor{stringliteral}{"C"} \{
00082 
00083 \textcolor{preprocessor}{#ifdef MTK\_PRECISION\_DOUBLE}
00084 \textcolor{preprocessor}{}
00097 \textcolor{keywordtype}{double} dnrm2\_(\textcolor{keywordtype}{int} *n, \textcolor{keywordtype}{double} *x, \textcolor{keywordtype}{int} *incx);
00098 \textcolor{preprocessor}{#else}
00099 \textcolor{preprocessor}{}
00112 \textcolor{keywordtype}{float} \hyperlink{namespacemtk_a508e99fcb14d526bc43aa0a80aa4b658}{snrm2\_}(\textcolor{keywordtype}{int} *n, \textcolor{keywordtype}{float} *x, \textcolor{keywordtype}{int} *incx);
00113 \textcolor{preprocessor}{#endif}
00114 \textcolor{preprocessor}{}
00115 \textcolor{preprocessor}{#ifdef MTK\_PRECISION\_DOUBLE}
00116 \textcolor{preprocessor}{}
00135 \textcolor{keywordtype}{void} daxpy\_(\textcolor{keywordtype}{int} *n, \textcolor{keywordtype}{double} *da, \textcolor{keywordtype}{double} *dx, \textcolor{keywordtype}{int} *incx, \textcolor{keywordtype}{double} *dy, \textcolor{keywordtype}{int} *incy);
00136 \textcolor{preprocessor}{#else}
00137 \textcolor{preprocessor}{}
00156 \textcolor{keywordtype}{void} \hyperlink{namespacemtk_a81a2d7d1ea9eff65ae13646c93dad5e9}{saxpy\_}(\textcolor{keywordtype}{int} *n, \textcolor{keywordtype}{float} *sa, \textcolor{keywordtype}{float} *sx, \textcolor{keywordtype}{int} *incx, \textcolor{keywordtype}{float} *sy, \textcolor{keywordtype}{int} *incy);
00157 \textcolor{preprocessor}{#endif}
00158 \textcolor{preprocessor}{}
00159 \textcolor{preprocessor}{#ifdef MTK\_PRECISION\_DOUBLE}
00160 \textcolor{preprocessor}{}
00188 \textcolor{keywordtype}{void} dgemv\_(\textcolor{keywordtype}{char} *trans,
00189             \textcolor{keywordtype}{int} *m,
00190             \textcolor{keywordtype}{int} *n,
00191             \textcolor{keywordtype}{double} *alpha,
00192             \textcolor{keywordtype}{double} *a,
00193             \textcolor{keywordtype}{int} *lda,
00194             \textcolor{keywordtype}{double} *x,
00195             \textcolor{keywordtype}{int} *incx,
00196             \textcolor{keywordtype}{double} *beta,
00197             \textcolor{keywordtype}{double} *y,
00198             \textcolor{keywordtype}{int} *incy);
00199 \textcolor{preprocessor}{#else}
00200 \textcolor{preprocessor}{}
00228 \textcolor{keywordtype}{void} \hyperlink{namespacemtk_a88daff7ad6f251a58b94aa2d0c94d069}{sgemv\_}(\textcolor{keywordtype}{char} *trans,
00229             \textcolor{keywordtype}{int} *m,
00230             \textcolor{keywordtype}{int} *n,
00231             \textcolor{keywordtype}{float} *alpha,
00232             \textcolor{keywordtype}{float} *a,
00233             \textcolor{keywordtype}{int} *lda,
00234             \textcolor{keywordtype}{float} *x,
00235             \textcolor{keywordtype}{int} *incx,
00236             \textcolor{keywordtype}{float} *beta,
00237             \textcolor{keywordtype}{float} *y,
00238             \textcolor{keywordtype}{int} *incy);
00239 \textcolor{preprocessor}{#endif}
00240 \textcolor{preprocessor}{}
00241 \textcolor{preprocessor}{#ifdef MTK\_PRECISION\_DOUBLE}
00242 \textcolor{preprocessor}{}
00267 \textcolor{keywordtype}{void} dgemm\_(\textcolor{keywordtype}{char} *transa,
00268             \textcolor{keywordtype}{char}* transb,
00269             \textcolor{keywordtype}{int} *m,
00270             \textcolor{keywordtype}{int} *n,
00271             \textcolor{keywordtype}{int} *k,
00272             \textcolor{keywordtype}{double} *alpha,
00273             \textcolor{keywordtype}{double} *a,
00274             \textcolor{keywordtype}{int} *lda,
00275             \textcolor{keywordtype}{double} *b,
00276             \textcolor{keywordtype}{int} *ldb,
00277             \textcolor{keywordtype}{double} *beta,
00278             \textcolor{keywordtype}{double} *c,
00279             \textcolor{keywordtype}{int} *ldc);
00280 \}
00281 \textcolor{preprocessor}{#else}
00282 \textcolor{preprocessor}{}
00307 \textcolor{keywordtype}{void} \hyperlink{namespacemtk_adb7c0560326b8e57f255e58b87ec76b0}{sgemm\_}(\textcolor{keywordtype}{char} *transa,
00308             \textcolor{keywordtype}{char}* transb,
00309             \textcolor{keywordtype}{int} *m,
00310             \textcolor{keywordtype}{int} *n,
00311             \textcolor{keywordtype}{int} *k,
00312             \textcolor{keywordtype}{double} *alpha,
00313             \textcolor{keywordtype}{double} *a,
00314             \textcolor{keywordtype}{int} *lda,
00315             \textcolor{keywordtype}{double} *b,aamm
00316             \textcolor{keywordtype}{int} *ldb,
00317             \textcolor{keywordtype}{double} *beta,
00318             \textcolor{keywordtype}{double} *c,
00319             \textcolor{keywordtype}{int} *ldc);
00320 \}
00321 \textcolor{preprocessor}{#endif}
00322 \textcolor{preprocessor}{}\}
00323 
\hypertarget{mtk__blas__adapter_8cc_source_l00324}{}\hyperlink{classmtk_1_1BLASAdapter_ab92440888b730863244c5d9479c11aca}{00324} \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{mtk::Real} \hyperlink{classmtk_1_1BLASAdapter_ab92440888b730863244c5d9479c11aca}{mtk::BLASAdapter::RealNRM2}(\hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{Real} *in, \textcolor{keywordtype}{int} &in\_length) \{
00325 
00326 \textcolor{preprocessor}{  #if MTK\_DEBUG\_LEVEL > 0}
00327 \textcolor{preprocessor}{}  \hyperlink{classmtk_1_1Tools_acbcff02946d3db565d53ecbcc459f0b5}{mtk::Tools::Prevent}(in\_length <= 0, \_\_FILE\_\_, \_\_LINE\_\_, \_\_func\_\_);
00328 \textcolor{preprocessor}{  #endif}
00329 \textcolor{preprocessor}{}
00330   \textcolor{keywordtype}{int} incx\{1\};  \textcolor{comment}{// Increment for the elements of xx. ix >= 0.}
00331 
00332 \textcolor{preprocessor}{  #ifdef MTK\_PRECISION\_DOUBLE}
00333 \textcolor{preprocessor}{}  \textcolor{keywordflow}{return} dnrm2\_(&in\_length, in, &incx);
00334 \textcolor{preprocessor}{  #else}
00335 \textcolor{preprocessor}{}  \textcolor{keywordflow}{return} \hyperlink{namespacemtk_a508e99fcb14d526bc43aa0a80aa4b658}{snrm2\_}(&in\_length, in, &incx);
00336 \textcolor{preprocessor}{  #endif}
00337 \textcolor{preprocessor}{}\}
00338 
\hypertarget{mtk__blas__adapter_8cc_source_l00339}{}\hyperlink{classmtk_1_1BLASAdapter_a081cd092ae65e730f44eae8643edd539}{00339} \textcolor{keywordtype}{void} \hyperlink{classmtk_1_1BLASAdapter_a081cd092ae65e730f44eae8643edd539}{mtk::BLASAdapter::RealAXPY}(\hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{mtk::Real} alpha,
00340                                      \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{mtk::Real} *xx,
00341                                      \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{mtk::Real} *yy,
00342                                      \textcolor{keywordtype}{int} &in\_length) \{
00343 
00344 \textcolor{preprocessor}{  #if MTK\_DEBUG\_LEVEL > 0}
00345 \textcolor{preprocessor}{}  \hyperlink{classmtk_1_1Tools_acbcff02946d3db565d53ecbcc459f0b5}{mtk::Tools::Prevent}(xx == \textcolor{keyword}{nullptr}, \_\_FILE\_\_, \_\_LINE\_\_, \_\_func\_\_);
00346   \hyperlink{classmtk_1_1Tools_acbcff02946d3db565d53ecbcc459f0b5}{mtk::Tools::Prevent}(yy == \textcolor{keyword}{nullptr}, \_\_FILE\_\_, \_\_LINE\_\_, \_\_func\_\_);
00347 \textcolor{preprocessor}{  #endif}
00348 \textcolor{preprocessor}{}
00349   \textcolor{keywordtype}{int} incx\{1\};  \textcolor{comment}{// Increment for the elements of xx. ix >= 0.}
00350 
00351 \textcolor{preprocessor}{  #ifdef MTK\_PRECISION\_DOUBLE}
00352 \textcolor{preprocessor}{}  daxpy\_(&in\_length, &alpha, xx, &incx, yy, &incx);
00353 \textcolor{preprocessor}{  #else}
00354 \textcolor{preprocessor}{}  \hyperlink{namespacemtk_a81a2d7d1ea9eff65ae13646c93dad5e9}{saxpy\_}(&in\_length, &alpha, xx, &incx, yy, &incx);
00355 \textcolor{preprocessor}{  #endif}
00356 \textcolor{preprocessor}{}\}
00357 
\hypertarget{mtk__blas__adapter_8cc_source_l00358}{}\hyperlink{classmtk_1_1BLASAdapter_af2ac5691f45e67d6e26186b071119ec4}{00358} \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{mtk::Real} \hyperlink{classmtk_1_1BLASAdapter_af2ac5691f45e67d6e26186b071119ec4}{mtk::BLASAdapter::RelNorm2Error}(
      \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{mtk::Real} *computed,
00359                                           \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{mtk::Real} *known,
00360                                           \textcolor{keywordtype}{int} length) \{
00361 
00362 \textcolor{preprocessor}{  #if MTK\_DEBUG\_LEVEL > 0}
00363 \textcolor{preprocessor}{}  \hyperlink{classmtk_1_1Tools_acbcff02946d3db565d53ecbcc459f0b5}{mtk::Tools::Prevent}(computed == \textcolor{keyword}{nullptr}, \_\_FILE\_\_, \_\_LINE\_\_, \_\_func\_\_);
00364   \hyperlink{classmtk_1_1Tools_acbcff02946d3db565d53ecbcc459f0b5}{mtk::Tools::Prevent}(known == \textcolor{keyword}{nullptr}, \_\_FILE\_\_, \_\_LINE\_\_, \_\_func\_\_);
00365 \textcolor{preprocessor}{  #endif}
00366 \textcolor{preprocessor}{}
00367   \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{mtk::Real} norm\_2\_computed\{\hyperlink{classmtk_1_1BLASAdapter_ab92440888b730863244c5d9479c11aca}{mtk::BLASAdapter::RealNRM2}(known, length)\};
00368 
00369   \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{mtk::Real} alpha\{-\hyperlink{group__c01-roots_ga26407c24d43b6b95480943340d285c71}{mtk::kOne}\};
00370 
00371   \hyperlink{classmtk_1_1BLASAdapter_a081cd092ae65e730f44eae8643edd539}{mtk::BLASAdapter::RealAXPY}(alpha, known, computed, length);
00372 
00373   \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{mtk::Real} norm\_2\_difference\{\hyperlink{classmtk_1_1BLASAdapter_ab92440888b730863244c5d9479c11aca}{mtk::BLASAdapter::RealNRM2}(computed, 
      length)\};
00374 
00375   \textcolor{keywordflow}{return} norm\_2\_difference/norm\_2\_computed;
00376 \}
00377 
\hypertarget{mtk__blas__adapter_8cc_source_l00378}{}\hyperlink{classmtk_1_1BLASAdapter_afdcac059a4294287cb55638221220646}{00378} \textcolor{keywordtype}{void} \hyperlink{classmtk_1_1BLASAdapter_afdcac059a4294287cb55638221220646}{mtk::BLASAdapter::RealDenseMV}(\hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{mtk::Real} &alpha,
00379                                    \hyperlink{classmtk_1_1DenseMatrix}{mtk::DenseMatrix} &aa,
00380                                    \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{mtk::Real} *xx,
00381                                    \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{mtk::Real} &beta,
00382                                    \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{mtk::Real} *yy) \{
00383 
00384   \textcolor{comment}{// Make sure input matrices are row-major ordered.}
00385 
00386   \textcolor{keywordflow}{if} (aa.\hyperlink{classmtk_1_1DenseMatrix_abb5e4db5688743c6f9fd9ec6e38ed4ca}{matrix\_properties}().\hyperlink{classmtk_1_1Matrix_af675e480c7b94f194aadad316e53b002}{ordering}() == 
      \hyperlink{namespacemtk_ga622801bd9f912d0f976c3e383f5f581ca7c11989c132253fb76b8f6b1314f7e13}{mtk::COL\_MAJOR}) \{
00387     aa.\hyperlink{classmtk_1_1DenseMatrix_ac2949efba3e8278335d45418c85433e4}{OrderRowMajor}();
00388   \}
00389 
00390   \textcolor{keywordtype}{char} transa\{\textcolor{charliteral}{'T'}\}; \textcolor{comment}{// State that now, the input WILL be in row-major ordering.}
00391 
00392   \textcolor{keywordtype}{int} mm\{aa.\hyperlink{classmtk_1_1DenseMatrix_a17d8d3b9cc0926044b6972dd190a5c21}{num\_rows}()\};                  \textcolor{comment}{// Rows of aa.}
00393   \textcolor{keywordtype}{int} nn\{aa.\hyperlink{classmtk_1_1DenseMatrix_af6f78373aaf2136f0c78974d7c8de0a8}{num\_cols}()\};                  \textcolor{comment}{// Columns of aa.}
00394   \textcolor{keywordtype}{int} lda\{(aa.\hyperlink{classmtk_1_1DenseMatrix_abb5e4db5688743c6f9fd9ec6e38ed4ca}{matrix\_properties}()).ld()\}; \textcolor{comment}{// Leading dimension.}
00395   \textcolor{keywordtype}{int} incx\{1\};                            \textcolor{comment}{// Increment of values in x.}
00396   \textcolor{keywordtype}{int} incy\{1\};                            \textcolor{comment}{// Increment of values in y.}
00397 
00398   std::swap(mm,nn);
00399 \textcolor{preprocessor}{  #ifdef MTK\_PRECISION\_DOUBLE}
00400 \textcolor{preprocessor}{}  dgemv\_(&transa, &mm, &nn, &alpha, aa.\hyperlink{classmtk_1_1DenseMatrix_a16b3ff56feb2658b9fc7147d1de4d8e7}{data}(), &lda,
00401          xx, &incx, &beta, yy, &incy);
00402 \textcolor{preprocessor}{  #else}
00403 \textcolor{preprocessor}{}  \hyperlink{namespacemtk_a88daff7ad6f251a58b94aa2d0c94d069}{sgemv\_}(&transa, &mm, &nn, &alpha, aa.\hyperlink{classmtk_1_1DenseMatrix_a16b3ff56feb2658b9fc7147d1de4d8e7}{data}(), &lda,
00404         xx, &incx, &beta, yy, &incy);
00405 \textcolor{preprocessor}{  #endif}
00406 \textcolor{preprocessor}{}  std::swap(mm,nn);
00407 \}
00408 
\hypertarget{mtk__blas__adapter_8cc_source_l00409}{}\hyperlink{classmtk_1_1BLASAdapter_acebd0e9bfe0bdd609c7fbea98ccfd3b5}{00409} \hyperlink{classmtk_1_1DenseMatrix}{mtk::DenseMatrix} \hyperlink{classmtk_1_1BLASAdapter_acebd0e9bfe0bdd609c7fbea98ccfd3b5}{mtk::BLASAdapter::RealDenseMM}(
      \hyperlink{classmtk_1_1DenseMatrix}{mtk::DenseMatrix} &aa,
00410                                                \hyperlink{classmtk_1_1DenseMatrix}{mtk::DenseMatrix} &bb) \{
00411 
00412 \textcolor{preprocessor}{  #if MTK\_DEBUG\_LEVEL > 0}
00413 \textcolor{preprocessor}{}  \hyperlink{classmtk_1_1Tools_acbcff02946d3db565d53ecbcc459f0b5}{mtk::Tools::Prevent}(aa.\hyperlink{classmtk_1_1DenseMatrix_af6f78373aaf2136f0c78974d7c8de0a8}{num\_cols}() != bb.\hyperlink{classmtk_1_1DenseMatrix_a17d8d3b9cc0926044b6972dd190a5c21}{num\_rows}(),
00414                       \_\_FILE\_\_, \_\_LINE\_\_, \_\_func\_\_);
00415 \textcolor{preprocessor}{  #endif}
00416 \textcolor{preprocessor}{}
00417   \textcolor{comment}{// Make sure input matrices are row-major ordered.}
00418 
00419   \textcolor{keywordflow}{if} (aa.\hyperlink{classmtk_1_1DenseMatrix_abb5e4db5688743c6f9fd9ec6e38ed4ca}{matrix\_properties}().\hyperlink{classmtk_1_1Matrix_af675e480c7b94f194aadad316e53b002}{ordering}() == 
      \hyperlink{namespacemtk_ga622801bd9f912d0f976c3e383f5f581ca7c11989c132253fb76b8f6b1314f7e13}{mtk::COL\_MAJOR}) \{
00420     aa.\hyperlink{classmtk_1_1DenseMatrix_ac2949efba3e8278335d45418c85433e4}{OrderRowMajor}();
00421   \}
00422   \textcolor{keywordflow}{if} (bb.\hyperlink{classmtk_1_1DenseMatrix_abb5e4db5688743c6f9fd9ec6e38ed4ca}{matrix\_properties}().\hyperlink{classmtk_1_1Matrix_af675e480c7b94f194aadad316e53b002}{ordering}() == 
      \hyperlink{namespacemtk_ga622801bd9f912d0f976c3e383f5f581ca7c11989c132253fb76b8f6b1314f7e13}{mtk::COL\_MAJOR}) \{
00423     bb.\hyperlink{classmtk_1_1DenseMatrix_ac2949efba3e8278335d45418c85433e4}{OrderRowMajor}();
00424   \}
00425 
00426   \textcolor{keywordtype}{char} ta\{\textcolor{charliteral}{'T'}\}; \textcolor{comment}{// State that input matrix aa is in row-wise ordering.}
00427   \textcolor{keywordtype}{char} tb\{\textcolor{charliteral}{'T'}\}; \textcolor{comment}{// State that input matrix bb is in row-wise ordering.}
00428 
00429   \textcolor{keywordtype}{int} mm\{aa.\hyperlink{classmtk_1_1DenseMatrix_a17d8d3b9cc0926044b6972dd190a5c21}{num\_rows}()\};  \textcolor{comment}{// Rows of aa and rows of cc.}
00430   \textcolor{keywordtype}{int} nn\{bb.\hyperlink{classmtk_1_1DenseMatrix_af6f78373aaf2136f0c78974d7c8de0a8}{num\_cols}()\};  \textcolor{comment}{// Cols of bb and cols of cc.}
00431   \textcolor{keywordtype}{int} kk\{aa.\hyperlink{classmtk_1_1DenseMatrix_af6f78373aaf2136f0c78974d7c8de0a8}{num\_cols}()\};  \textcolor{comment}{// Cols of aa and rows of bb.}
00432 
00433   \textcolor{keywordtype}{int} cc\_num\_rows\{mm\};  \textcolor{comment}{// Rows of cc.}
00434   \textcolor{keywordtype}{int} cc\_num\_cols\{nn\};  \textcolor{comment}{// Columns of cc.}
00435 
00436   \textcolor{keywordtype}{int} lda\{std::max(1,kk)\};  \textcolor{comment}{// Leading dimension of the aa matrix.}
00437   \textcolor{keywordtype}{int} ldb\{std::max(1,nn)\};  \textcolor{comment}{// Leading dimension of the bb matrix.}
00438   \textcolor{keywordtype}{int} ldc\{std::max(1,mm)\};  \textcolor{comment}{// Leading dimension of the cc matrix.}
00439 
00440   \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{mtk::Real} alpha\{1.0\}; \textcolor{comment}{// First scalar coefficient.}
00441   \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{mtk::Real} beta\{0.0\};  \textcolor{comment}{// Second scalar coefficient.}
00442 
00443   \hyperlink{classmtk_1_1DenseMatrix}{mtk::DenseMatrix} cc\_col\_maj\_ord(cc\_num\_rows,cc\_num\_cols); \textcolor{comment}{// Output matrix.}
00444 
00445   cc\_col\_maj\_ord.\hyperlink{classmtk_1_1DenseMatrix_aacae136ae446cad8f0d81476e83efb39}{SetOrdering}(\hyperlink{namespacemtk_ga622801bd9f912d0f976c3e383f5f581ca7c11989c132253fb76b8f6b1314f7e13}{mtk::COL\_MAJOR});
00446 
00447 \textcolor{preprocessor}{  #ifdef MTK\_PRECISION\_DOUBLE}
00448 \textcolor{preprocessor}{}  dgemm\_(&ta, &tb, &mm, &nn, &kk, &alpha, aa.\hyperlink{classmtk_1_1DenseMatrix_a16b3ff56feb2658b9fc7147d1de4d8e7}{data}(), &lda,
00449          bb.\hyperlink{classmtk_1_1DenseMatrix_a16b3ff56feb2658b9fc7147d1de4d8e7}{data}(), &ldb, &beta, cc\_col\_maj\_ord.\hyperlink{classmtk_1_1DenseMatrix_a16b3ff56feb2658b9fc7147d1de4d8e7}{data}(), &ldc);
00450 \textcolor{preprocessor}{  #else}
00451 \textcolor{preprocessor}{}  \hyperlink{namespacemtk_adb7c0560326b8e57f255e58b87ec76b0}{sgemm\_}(&ta, &tb, &mm, &nn, &kk, &alpha, aa.\hyperlink{classmtk_1_1DenseMatrix_a16b3ff56feb2658b9fc7147d1de4d8e7}{data}(), &lda,
00452          bb.\hyperlink{classmtk_1_1DenseMatrix_a16b3ff56feb2658b9fc7147d1de4d8e7}{data}(), &ldb, &beta, cc\_col\_maj\_ord.\hyperlink{classmtk_1_1DenseMatrix_a16b3ff56feb2658b9fc7147d1de4d8e7}{data}(), &ldc);
00453 \textcolor{preprocessor}{  #endif}
00454 \textcolor{preprocessor}{}
00455 \textcolor{preprocessor}{  #if MTK\_DEBUG\_LEVEL > 0}
00456 \textcolor{preprocessor}{}  std::cout << \textcolor{stringliteral}{"cc\_col\_maj\_ord ="} << std::endl;
00457   std::cout << cc\_col\_maj\_ord << std::endl;
00458 \textcolor{preprocessor}{  #endif}
00459 \textcolor{preprocessor}{}
00460   cc\_col\_maj\_ord.\hyperlink{classmtk_1_1DenseMatrix_ac2949efba3e8278335d45418c85433e4}{OrderRowMajor}();
00461 
00462   \textcolor{keywordflow}{return} cc\_col\_maj\_ord;
00463 \}
\end{DoxyCode}
