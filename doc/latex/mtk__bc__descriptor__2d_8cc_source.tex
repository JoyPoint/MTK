\hypertarget{mtk__bc__descriptor__2d_8cc_source}{\section{mtk\+\_\+bc\+\_\+descriptor\+\_\+2d.\+cc}
\label{mtk__bc__descriptor__2d_8cc_source}\index{src/mtk\+\_\+bc\+\_\+descriptor\+\_\+2d.\+cc@{src/mtk\+\_\+bc\+\_\+descriptor\+\_\+2d.\+cc}}
}

\begin{DoxyCode}
00001 
00011 \textcolor{comment}{/*}
00012 \textcolor{comment}{Copyright (C) 2015, Computational Science Research Center, San Diego State}
00013 \textcolor{comment}{University. All rights reserved.}
00014 \textcolor{comment}{}
00015 \textcolor{comment}{Redistribution and use in source and binary forms, with or without modification,}
00016 \textcolor{comment}{are permitted provided that the following conditions are met:}
00017 \textcolor{comment}{}
00018 \textcolor{comment}{1. Modifications to source code should be reported to: esanchez@mail.sdsu.edu}
00019 \textcolor{comment}{and a copy of the modified files should be reported once modifications are}
00020 \textcolor{comment}{completed, unless these modifications are made through the project's GitHub}
00021 \textcolor{comment}{page: http://www.csrc.sdsu.edu/mtk. Documentation related to said modifications}
00022 \textcolor{comment}{should be developed and included in any deliverable.}
00023 \textcolor{comment}{}
00024 \textcolor{comment}{2. Redistributions of source code must be done through direct}
00025 \textcolor{comment}{downloads from the project's GitHub page: http://www.csrc.sdsu.edu/mtk}
00026 \textcolor{comment}{}
00027 \textcolor{comment}{3. Redistributions in binary form must reproduce the above copyright notice,}
00028 \textcolor{comment}{this list of conditions and the following disclaimer in the documentation and/or}
00029 \textcolor{comment}{other materials provided with the distribution.}
00030 \textcolor{comment}{}
00031 \textcolor{comment}{4. Usage of the binary form on proprietary applications shall require explicit}
00032 \textcolor{comment}{prior written permission from the the copyright holders, and due credit should}
00033 \textcolor{comment}{be given to the copyright holders.}
00034 \textcolor{comment}{}
00035 \textcolor{comment}{5. Neither the name of the copyright holder nor the names of its contributors}
00036 \textcolor{comment}{may be used to endorse or promote products derived from this software without}
00037 \textcolor{comment}{specific prior written permission.}
00038 \textcolor{comment}{}
00039 \textcolor{comment}{The copyright holders provide no reassurances that the source code provided does}
00040 \textcolor{comment}{not infringe any patent, copyright, or any other intellectual property rights of}
00041 \textcolor{comment}{third parties. The copyright holders disclaim any liability to any recipient for}
00042 \textcolor{comment}{claims brought against recipient by any third party for infringement of that}
00043 \textcolor{comment}{parties intellectual property rights.}
00044 \textcolor{comment}{}
00045 \textcolor{comment}{THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND}
00046 \textcolor{comment}{ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED}
00047 \textcolor{comment}{WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE}
00048 \textcolor{comment}{DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR}
00049 \textcolor{comment}{ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES}
00050 \textcolor{comment}{(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;}
00051 \textcolor{comment}{LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON}
00052 \textcolor{comment}{ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT}
00053 \textcolor{comment}{(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS}
00054 \textcolor{comment}{SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.}
00055 \textcolor{comment}{*/}
00056 
00057 \textcolor{preprocessor}{#include "\hyperlink{mtk__tools_8h}{mtk\_tools.h}"}
00058 
00059 \textcolor{preprocessor}{#include "\hyperlink{mtk__bc__descriptor__2d_8h}{mtk\_bc\_descriptor\_2d.h}"}
00060 
\hypertarget{mtk__bc__descriptor__2d_8cc_source_l00061}{}\hyperlink{classmtk_1_1BCDescriptor2D_abbc3af29202dbfef203f4cafd9566fd0}{00061} \hyperlink{classmtk_1_1BCDescriptor2D_abbc3af29202dbfef203f4cafd9566fd0}{mtk::BCDescriptor2D::BCDescriptor2D}():
00062   highest\_order\_diff\_west\_(-1),
00063   highest\_order\_diff\_east\_(-1),
00064   highest\_order\_diff\_south\_(-1),
00065   highest\_order\_diff\_north\_(-1),
00066   west\_condition\_(),
00067   east\_condition\_(),
00068   south\_condition\_(),
00069   north\_condition\_() \{\}
00070 
\hypertarget{mtk__bc__descriptor__2d_8cc_source_l00071}{}\hyperlink{classmtk_1_1BCDescriptor2D_ae8a93352a94efed52747b710e6ff7893}{00071} \hyperlink{classmtk_1_1BCDescriptor2D_abbc3af29202dbfef203f4cafd9566fd0}{mtk::BCDescriptor2D::BCDescriptor2D}(\textcolor{keyword}{const} 
      \hyperlink{classmtk_1_1BCDescriptor2D}{mtk::BCDescriptor2D} &desc) \{\}
00072 
\hypertarget{mtk__bc__descriptor__2d_8cc_source_l00073}{}\hyperlink{classmtk_1_1BCDescriptor2D_ae14e62548a8bc080d576fff6937c546b}{00073} \hyperlink{classmtk_1_1BCDescriptor2D_ae14e62548a8bc080d576fff6937c546b}{mtk::BCDescriptor2D::~BCDescriptor2D}() noexcept \{\}
00074 
\hypertarget{mtk__bc__descriptor__2d_8cc_source_l00075}{}\hyperlink{classmtk_1_1BCDescriptor2D_a0fa469ddf6ff76e2858d6d3b76cc8b6f}{00075} \textcolor{keywordtype}{int} \hyperlink{classmtk_1_1BCDescriptor2D_a0fa469ddf6ff76e2858d6d3b76cc8b6f}{mtk::BCDescriptor2D::highest\_order\_diff\_west}() const 
      noexcept \{
00076 
00077   \textcolor{keywordflow}{return} highest\_order\_diff\_west\_;
00078 \}
00079 
\hypertarget{mtk__bc__descriptor__2d_8cc_source_l00080}{}\hyperlink{classmtk_1_1BCDescriptor2D_a5a9b80a2e9e579b05d9f3589d80448b6}{00080} \textcolor{keywordtype}{int} \hyperlink{classmtk_1_1BCDescriptor2D_a5a9b80a2e9e579b05d9f3589d80448b6}{mtk::BCDescriptor2D::highest\_order\_diff\_east}() const 
      noexcept \{
00081 
00082   \textcolor{keywordflow}{return} highest\_order\_diff\_east\_;
00083 \}
00084 
\hypertarget{mtk__bc__descriptor__2d_8cc_source_l00085}{}\hyperlink{classmtk_1_1BCDescriptor2D_a463d909f6014e7f01b33171a06d7b400}{00085} \textcolor{keywordtype}{int} \hyperlink{classmtk_1_1BCDescriptor2D_a463d909f6014e7f01b33171a06d7b400}{mtk::BCDescriptor2D::highest\_order\_diff\_south}() const 
      noexcept \{
00086 
00087   \textcolor{keywordflow}{return} highest\_order\_diff\_south\_;
00088 \}
00089 
\hypertarget{mtk__bc__descriptor__2d_8cc_source_l00090}{}\hyperlink{classmtk_1_1BCDescriptor2D_a87c5f2449247d65ea07784ba2ec61bc7}{00090} \textcolor{keywordtype}{int} \hyperlink{classmtk_1_1BCDescriptor2D_a87c5f2449247d65ea07784ba2ec61bc7}{mtk::BCDescriptor2D::highest\_order\_diff\_north}() const 
      noexcept \{
00091 
00092   \textcolor{keywordflow}{return} highest\_order\_diff\_north\_;
00093 \}
00094 
\hypertarget{mtk__bc__descriptor__2d_8cc_source_l00095}{}\hyperlink{classmtk_1_1BCDescriptor2D_a3da32ba89cfb15032bb1156394bad98c}{00095} \textcolor{keywordtype}{void} \hyperlink{classmtk_1_1BCDescriptor2D_a3da32ba89cfb15032bb1156394bad98c}{mtk::BCDescriptor2D::PushBackWestCoeff}(
      \hyperlink{group__c07-mim__ops_gad9e1c0ace886b0029aefffa5f320e852}{mtk::CoefficientFunction2D} cw) \{
00096 
00097 \textcolor{preprocessor}{  #if MTK\_DEBUG\_LEVEL > 0}
00098   \hyperlink{classmtk_1_1Tools_a332324c6f25e66be9dff48c5987a3b9f}{mtk::Tools::Prevent}(cw == \textcolor{keyword}{nullptr}, \_\_FILE\_\_, \_\_LINE\_\_, \_\_func\_\_);
00099 \textcolor{preprocessor}{  #endif}
00100 
00101   west\_coefficients\_.push\_back(cw);
00102 
00103   highest\_order\_diff\_west\_++;
00104 \}
00105 
\hypertarget{mtk__bc__descriptor__2d_8cc_source_l00106}{}\hyperlink{classmtk_1_1BCDescriptor2D_a27635428a6c36d1e305cafdc68271063}{00106} \textcolor{keywordtype}{void} \hyperlink{classmtk_1_1BCDescriptor2D_a27635428a6c36d1e305cafdc68271063}{mtk::BCDescriptor2D::PushBackEastCoeff}(
      \hyperlink{group__c07-mim__ops_gad9e1c0ace886b0029aefffa5f320e852}{mtk::CoefficientFunction2D} ce) \{
00107 
00108 \textcolor{preprocessor}{  #if MTK\_DEBUG\_LEVEL > 0}
00109   \hyperlink{classmtk_1_1Tools_a332324c6f25e66be9dff48c5987a3b9f}{mtk::Tools::Prevent}(ce == \textcolor{keyword}{nullptr}, \_\_FILE\_\_, \_\_LINE\_\_, \_\_func\_\_);
00110 \textcolor{preprocessor}{  #endif}
00111 
00112   east\_coefficients\_.push\_back(ce);
00113 
00114   highest\_order\_diff\_east\_++;
00115 \}
00116 
\hypertarget{mtk__bc__descriptor__2d_8cc_source_l00117}{}\hyperlink{classmtk_1_1BCDescriptor2D_a9eb891f14c68968a0113632fa5fea630}{00117} \textcolor{keywordtype}{void} \hyperlink{classmtk_1_1BCDescriptor2D_a9eb891f14c68968a0113632fa5fea630}{mtk::BCDescriptor2D::PushBackSouthCoeff}(
      \hyperlink{group__c07-mim__ops_gad9e1c0ace886b0029aefffa5f320e852}{mtk::CoefficientFunction2D} cs) \{
00118 
00119 \textcolor{preprocessor}{  #if MTK\_DEBUG\_LEVEL > 0}
00120   \hyperlink{classmtk_1_1Tools_a332324c6f25e66be9dff48c5987a3b9f}{mtk::Tools::Prevent}(cs == \textcolor{keyword}{nullptr}, \_\_FILE\_\_, \_\_LINE\_\_, \_\_func\_\_);
00121 \textcolor{preprocessor}{  #endif}
00122 
00123   south\_coefficients\_.push\_back(cs);
00124 
00125   highest\_order\_diff\_south\_++;
00126 \}
00127 
\hypertarget{mtk__bc__descriptor__2d_8cc_source_l00128}{}\hyperlink{classmtk_1_1BCDescriptor2D_a0fed58bd058d699a572888fe4b9934a4}{00128} \textcolor{keywordtype}{void} \hyperlink{classmtk_1_1BCDescriptor2D_a0fed58bd058d699a572888fe4b9934a4}{mtk::BCDescriptor2D::PushBackNorthCoeff}(
      \hyperlink{group__c07-mim__ops_gad9e1c0ace886b0029aefffa5f320e852}{mtk::CoefficientFunction2D} cn) \{
00129 
00130 \textcolor{preprocessor}{  #if MTK\_DEBUG\_LEVEL > 0}
00131   \hyperlink{classmtk_1_1Tools_a332324c6f25e66be9dff48c5987a3b9f}{mtk::Tools::Prevent}(cn == \textcolor{keyword}{nullptr}, \_\_FILE\_\_, \_\_LINE\_\_, \_\_func\_\_);
00132 \textcolor{preprocessor}{  #endif}
00133 
00134   north\_coefficients\_.push\_back(cn);
00135 
00136   highest\_order\_diff\_north\_++;
00137 \}
00138 
\hypertarget{mtk__bc__descriptor__2d_8cc_source_l00139}{}\hyperlink{classmtk_1_1BCDescriptor2D_a006050efe15b1be75b36a74a23051392}{00139} \textcolor{keywordtype}{void} \hyperlink{classmtk_1_1BCDescriptor2D_a006050efe15b1be75b36a74a23051392}{mtk::BCDescriptor2D::set\_west\_condition}(
00140     \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{mtk::Real} (*west\_condition)(\hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{mtk::Real} xx, \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{mtk::Real} yy)) noexcept \{
00141 
00142 \textcolor{preprocessor}{  #if MTK\_DEBUG\_LEVEL > 0}
00143   \hyperlink{classmtk_1_1Tools_a332324c6f25e66be9dff48c5987a3b9f}{mtk::Tools::Prevent}(west\_condition == \textcolor{keyword}{nullptr}, \_\_FILE\_\_, \_\_LINE\_\_, \_\_func\_\_);
00144 \textcolor{preprocessor}{  #endif}
00145 
00146   west\_condition\_ = west\_condition;
00147 \}
00148 
\hypertarget{mtk__bc__descriptor__2d_8cc_source_l00149}{}\hyperlink{classmtk_1_1BCDescriptor2D_a4ba8690e845f59a1507b056f3fc8061e}{00149} \textcolor{keywordtype}{void} \hyperlink{classmtk_1_1BCDescriptor2D_a4ba8690e845f59a1507b056f3fc8061e}{mtk::BCDescriptor2D::set\_east\_condition}(
00150     \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{mtk::Real} (*east\_condition)(\hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{mtk::Real} xx, \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{mtk::Real} yy)) noexcept \{
00151 
00152 \textcolor{preprocessor}{  #if MTK\_DEBUG\_LEVEL > 0}
00153   \hyperlink{classmtk_1_1Tools_a332324c6f25e66be9dff48c5987a3b9f}{mtk::Tools::Prevent}(east\_condition == \textcolor{keyword}{nullptr}, \_\_FILE\_\_, \_\_LINE\_\_, \_\_func\_\_);
00154 \textcolor{preprocessor}{  #endif}
00155 
00156   east\_condition\_ = east\_condition;
00157 \}
00158 
\hypertarget{mtk__bc__descriptor__2d_8cc_source_l00159}{}\hyperlink{classmtk_1_1BCDescriptor2D_a408f159cc44d7ee610191efb8ed48b2a}{00159} \textcolor{keywordtype}{void} \hyperlink{classmtk_1_1BCDescriptor2D_a408f159cc44d7ee610191efb8ed48b2a}{mtk::BCDescriptor2D::set\_south\_condition}(
00160     \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{mtk::Real} (*south\_condition)(\hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{mtk::Real} xx, \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{mtk::Real} yy)) noexcept \{
00161 
00162 \textcolor{preprocessor}{  #if MTK\_DEBUG\_LEVEL > 0}
00163   \hyperlink{classmtk_1_1Tools_a332324c6f25e66be9dff48c5987a3b9f}{mtk::Tools::Prevent}(south\_condition == \textcolor{keyword}{nullptr},
00164                       \_\_FILE\_\_, \_\_LINE\_\_, \_\_func\_\_);
00165 \textcolor{preprocessor}{  #endif}
00166 
00167   south\_condition\_ = south\_condition;
00168 \}
00169 
\hypertarget{mtk__bc__descriptor__2d_8cc_source_l00170}{}\hyperlink{classmtk_1_1BCDescriptor2D_a690f6881a88b202c074d9f90f2a7ddb0}{00170} \textcolor{keywordtype}{void} \hyperlink{classmtk_1_1BCDescriptor2D_a690f6881a88b202c074d9f90f2a7ddb0}{mtk::BCDescriptor2D::set\_north\_condition}(
00171     \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{mtk::Real} (*north\_condition)(\hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{mtk::Real} xx, \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{mtk::Real} yy)) noexcept \{
00172 
00173 \textcolor{preprocessor}{  #if MTK\_DEBUG\_LEVEL > 0}
00174   \hyperlink{classmtk_1_1Tools_a332324c6f25e66be9dff48c5987a3b9f}{mtk::Tools::Prevent}(north\_condition\_ == \textcolor{keyword}{nullptr},
00175                       \_\_FILE\_\_, \_\_LINE\_\_, \_\_func\_\_);
00176 \textcolor{preprocessor}{  #endif}
00177 
00178   north\_condition\_ = north\_condition;
00179 \}
00180 
\hypertarget{mtk__bc__descriptor__2d_8cc_source_l00181}{}\hyperlink{classmtk_1_1BCDescriptor2D_abade249fa28783a5383a7c2aaf570ea9}{00181} \textcolor{keywordtype}{void} \hyperlink{classmtk_1_1BCDescriptor2D_abade249fa28783a5383a7c2aaf570ea9}{mtk::BCDescriptor2D::ImposeOnLaplacianMatrix}(
00182     \textcolor{keyword}{const} \hyperlink{classmtk_1_1UniStgGrid2D}{mtk::UniStgGrid2D} &grid,
00183     \hyperlink{classmtk_1_1DenseMatrix}{mtk::DenseMatrix} &matrix)\textcolor{keyword}{ const }\{
00184 
00185 \textcolor{preprocessor}{  #if MTK\_DEBUG\_LEVEL > 0}
00186   \hyperlink{classmtk_1_1Tools_a332324c6f25e66be9dff48c5987a3b9f}{mtk::Tools::Prevent}(grid.\hyperlink{classmtk_1_1UniStgGrid2D_a99a3a9cdb05b7306be99bde935509e30}{nature}() != \hyperlink{namespacemtk_ga4c54f2a329cfb4e56213b02a259d19e2af481d45bd70d41381c7d72e200889205}{mtk::SCALAR},
00187                       \_\_FILE\_\_, \_\_LINE\_\_, \_\_func\_\_);
00188   \hyperlink{classmtk_1_1Tools_a332324c6f25e66be9dff48c5987a3b9f}{mtk::Tools::Prevent}(grid.\hyperlink{classmtk_1_1UniStgGrid2D_a2d182866a398aba8e4829590e85bf939}{num\_cells\_x}() == 0, \_\_FILE\_\_, \_\_LINE\_\_, \_\_func\_\_);
00189   \hyperlink{classmtk_1_1Tools_a332324c6f25e66be9dff48c5987a3b9f}{mtk::Tools::Prevent}(grid.\hyperlink{classmtk_1_1UniStgGrid2D_aed05a801cc9a76dba0ff203cea58a61a}{num\_cells\_y}() == 0, \_\_FILE\_\_, \_\_LINE\_\_, \_\_func\_\_);
00190   \hyperlink{classmtk_1_1Tools_a332324c6f25e66be9dff48c5987a3b9f}{mtk::Tools::Prevent}(matrix.\hyperlink{classmtk_1_1DenseMatrix_a53f3afb3b6a8d21854458aaa9663cc74}{num\_rows}() == 0, \_\_FILE\_\_, \_\_LINE\_\_, \_\_func\_\_);
00191   \hyperlink{classmtk_1_1Tools_a332324c6f25e66be9dff48c5987a3b9f}{mtk::Tools::Prevent}(matrix.\hyperlink{classmtk_1_1DenseMatrix_a41747502d468c6728a4be31501b16e0e}{num\_cols}() == 0, \_\_FILE\_\_, \_\_LINE\_\_, \_\_func\_\_);
00192 \textcolor{preprocessor}{  #endif}
00193 
00196 
00197   \textcolor{keywordtype}{bool} generate\_space\{\textcolor{keyword}{false}\};
00198 
00199   \textcolor{keywordflow}{if} (!grid.\hyperlink{classmtk_1_1UniStgGrid2D_aa651194ccd0321a7c61a8f56fa5e8455}{Bound}()) \{
00200     generate\_space = \textcolor{keyword}{true};
00201   \}
00202 
00204 
00205   \textcolor{keywordflow}{if} (generate\_space) \{
00206     \textcolor{comment}{// For the south-west corner:}
00207     \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{mtk::Real} cc\{\};
00208     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} jj = 0; jj < south\_coefficients\_.size(); ++jj) \{
00209       \textcolor{comment}{// Evaluate the coefficient on the grid.}
00210       cc += (south\_coefficients\_[jj])(grid.\hyperlink{classmtk_1_1UniStgGrid2D_af2b1712387ded85edaf2b64617d3fc13}{west\_bndy}(), grid.\hyperlink{classmtk_1_1UniStgGrid2D_a1442eaf219f099d0ebf46a170fdebf92}{south\_bndy}());
00211     \}
00212     matrix.\hyperlink{classmtk_1_1DenseMatrix_a784ce5784109ac86bfb9d8562b334b13}{SetValue}(0, 0, cc);
00213 
00214     \textcolor{comment}{// Compute first centers per dimension.}
00215 \textcolor{preprocessor}{    #ifdef MTK\_PRECISION\_DOUBLE}
00216     \textcolor{keyword}{auto} first\_center\_x = grid.\hyperlink{classmtk_1_1UniStgGrid2D_af2b1712387ded85edaf2b64617d3fc13}{west\_bndy}() + grid.\hyperlink{classmtk_1_1UniStgGrid2D_aca4710004c4a7da6a9e8fd6ab32a691f}{delta\_x}()/2.0;
00217 \textcolor{preprocessor}{    #else}
00218     \textcolor{keyword}{auto} first\_center\_x = grid.\hyperlink{classmtk_1_1UniStgGrid2D_af2b1712387ded85edaf2b64617d3fc13}{west\_bndy}() + grid.\hyperlink{classmtk_1_1UniStgGrid2D_aca4710004c4a7da6a9e8fd6ab32a691f}{delta\_x}()/2.0f;
00219 \textcolor{preprocessor}{    #endif}
00220 
00221 \textcolor{preprocessor}{    #ifdef MTK\_PRECISION\_DOUBLE}
00222     \textcolor{keyword}{auto} first\_center\_y = grid.\hyperlink{classmtk_1_1UniStgGrid2D_a1442eaf219f099d0ebf46a170fdebf92}{south\_bndy}() + grid.\hyperlink{classmtk_1_1UniStgGrid2D_a65a78cfc80ffdbeb282ed57af4dc5cb4}{delta\_y}()/2.0;
00223 \textcolor{preprocessor}{    #else}
00224     \textcolor{keyword}{auto} first\_center\_y = grid.\hyperlink{classmtk_1_1UniStgGrid2D_a1442eaf219f099d0ebf46a170fdebf92}{south\_bndy}() + grid.\hyperlink{classmtk_1_1UniStgGrid2D_a65a78cfc80ffdbeb282ed57af4dc5cb4}{delta\_y}()/2.0f;
00225 \textcolor{preprocessor}{    #endif}
00226 
00227     \textcolor{comment}{// For each entry on the diagonal (south boundary):}
00228     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} ii = 0; ii < grid.\hyperlink{classmtk_1_1UniStgGrid2D_a2d182866a398aba8e4829590e85bf939}{num\_cells\_x}(); ++ii) \{
00229       \textcolor{comment}{// Evaluate next set spatial coordinates to evaluate the coefficient at.}
00230       \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{mtk::Real} xx = first\_center\_x + ii*grid.\hyperlink{classmtk_1_1UniStgGrid2D_aca4710004c4a7da6a9e8fd6ab32a691f}{delta\_x}();
00231       \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{mtk::Real} yy = first\_center\_y + ii*grid.\hyperlink{classmtk_1_1UniStgGrid2D_a65a78cfc80ffdbeb282ed57af4dc5cb4}{delta\_y}();
00232 
00233       cc = 0;
00234       \textcolor{comment}{// For each coefficient to sum:}
00235       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} jj = 0; jj < south\_coefficients\_.size(); ++jj) \{
00236         \textcolor{comment}{// Evaluate the coefficient on the grid and accumulate.}
00237         cc += (south\_coefficients\_[jj])(xx, yy);
00238       \}
00239       matrix.\hyperlink{classmtk_1_1DenseMatrix_a784ce5784109ac86bfb9d8562b334b13}{SetValue}(ii + 1, ii + 1, cc);
00240     \}
00241 
00242     \textcolor{comment}{// For the south-east corner:}
00243     cc = 0;
00244     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} jj = 0; jj < south\_coefficients\_.size(); ++jj) \{
00245       \textcolor{comment}{// Evaluate the coefficient on the grid.}
00246       cc += (south\_coefficients\_[jj])(grid.\hyperlink{classmtk_1_1UniStgGrid2D_a03f689eb29a6369b82ce1207c655d5ff}{east\_bndy}(), grid.\hyperlink{classmtk_1_1UniStgGrid2D_a1442eaf219f099d0ebf46a170fdebf92}{south\_bndy}());
00247     \}
00248     matrix.\hyperlink{classmtk_1_1DenseMatrix_a784ce5784109ac86bfb9d8562b334b13}{SetValue}(grid.\hyperlink{classmtk_1_1UniStgGrid2D_a2d182866a398aba8e4829590e85bf939}{num\_cells\_x}() + 1, grid.\hyperlink{classmtk_1_1UniStgGrid2D_a2d182866a398aba8e4829590e85bf939}{num\_cells\_x}() + 1, cc);
00249 
00250   \} \textcolor{keywordflow}{else} \{
00251     \textcolor{comment}{// For each entry on the diagonal:}
00252     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} ii = 0; ii < grid.\hyperlink{classmtk_1_1UniStgGrid2D_a2d182866a398aba8e4829590e85bf939}{num\_cells\_x}() + 2; ++ii) \{
00253       \textcolor{comment}{// For each coefficient to sum:}
00254       \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{mtk::Real} xx\{(grid.\hyperlink{classmtk_1_1UniStgGrid2D_ab2f70cf5cd0a2d5486992d9f2f8baa4a}{discrete\_domain\_x}())[ii]\};
00255       \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{mtk::Real} yy\{(grid.\hyperlink{classmtk_1_1UniStgGrid2D_ac33a58d65105550dcf6f6b92b48b5105}{discrete\_domain\_y}())[ii]\};
00256       \hyperlink{group__c01-roots_gac080bbbf5cbb5502c9f00405f894857d}{mtk::Real} cc\{\};
00257       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} jj = 0; jj < south\_coefficients\_.size(); ++jj) \{
00258         \textcolor{comment}{// Evaluate the coefficient on the grid.}
00259         cc += (south\_coefficients\_[jj])(xx,yy);
00260       \}
00261       matrix.\hyperlink{classmtk_1_1DenseMatrix_a784ce5784109ac86bfb9d8562b334b13}{SetValue}(ii, ii, cc);
00262     \}
00263   \}
00264 
00265 
00267 \}
00268 
\hypertarget{mtk__bc__descriptor__2d_8cc_source_l00269}{}\hyperlink{classmtk_1_1BCDescriptor2D_a5f0ff1fda1b5266dcd77ba2301c8ba2c}{00269} \textcolor{keywordtype}{void} \hyperlink{classmtk_1_1BCDescriptor2D_a5f0ff1fda1b5266dcd77ba2301c8ba2c}{mtk::BCDescriptor2D::ImposeOnGrid}(
      \hyperlink{classmtk_1_1UniStgGrid2D}{mtk::UniStgGrid2D} &grid)\textcolor{keyword}{ const }\{
00270 
00271 \textcolor{preprocessor}{  #if MTK\_DEBUG\_LEVEL > 0}
00272   \hyperlink{classmtk_1_1Tools_a332324c6f25e66be9dff48c5987a3b9f}{mtk::Tools::Prevent}(grid.\hyperlink{classmtk_1_1UniStgGrid2D_a2d182866a398aba8e4829590e85bf939}{num\_cells\_x}() == 0, \_\_FILE\_\_, \_\_LINE\_\_, \_\_func\_\_);
00273   \hyperlink{classmtk_1_1Tools_a332324c6f25e66be9dff48c5987a3b9f}{mtk::Tools::Prevent}(grid.\hyperlink{classmtk_1_1UniStgGrid2D_aed05a801cc9a76dba0ff203cea58a61a}{num\_cells\_y}() == 0, \_\_FILE\_\_, \_\_LINE\_\_, \_\_func\_\_);
00274 \textcolor{preprocessor}{  #endif}
00275 
00276 
00277 \}
\end{DoxyCode}
